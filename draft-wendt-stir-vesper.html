<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>VESPER PASSporT and Identity Tokens - VErifiable STI Personas</title>
<meta content="Chris Wendt" name="author">
<meta content="Rob Sliwa" name="author">
<meta content="
       This document extends the STIR architecture by defining a Personal Assertion Token (PASSporT) with a type of &quot;vesper&quot; (VErifiable Sti PERsona) and specifies the use of PASSporTs as a JSON Web Tokens (JWT) and Selective Disclosure JWT (SD-JWT) for representing verifiable claims related to a persona (a person or business entity) associated with a Secure Telephone Identity (STI). This set of extensible claims can include verifiable information such as the assignment of a telephone number, the output of a Know Your Customer (KYC) or Know Your Business (KYB) type of vetting process, Rich Call Data (RCD) or claims of consent provided to the telephone number holder. The architecture, dependencies, and process flow of Vesper includes logical roles that represent certain responsibilities for establishing a secure telephone identity. These roles represent the basis for trusted relationships to information that is being claimed and who is validating and taking responsibility for the accuracy of that information. These roles begin with a Subject Entity (SE) that is the end entity that intended to be represented by the STI telephone number identifier. A Vetting Claim Agent (VCA) establishes the Subject Entity as a vetted entity after performing the initial vetting and existence as a entity that fulfills the criteria and policies of the ecosystem to be associated with an STI. A Notary Agent (NA) is a neutral role that maintains a graph of relationships among all roles, claims, and identities, but importantly, for protecting privacy, doesn't hold any claim information other than the recording of claim events to the STI telephone number. The NA records these claim event transactions with a corresponding transparency log that generates verifiable receipts to &quot;notarize&quot; the recording of these relationships and claims being established. Privacy is enabled in this Notary role because the submitters have the option of submitting hashes of claims to protect information, or may usefully want to publicly declare their association to a claim to allow the public monitoring to avoid duplicate, mistaken or negligent claims which can be identified before illegitimate usage in the eco-system can occur. Other Claim Agents are defined producing claims in the form of SD-JWT + receipts from the NA. There are multiple claim agent types with corresponding extensible claim definitions with key value pairs that can be required or optionally included. These SD-JWT + receipt claim objects are then collected by the SE into a digital wallet that it can then use for selective disclosure presentation and incorporate into a &quot;vesper&quot; PASSporT signed by the a delegate certificate associated with STI telephone number to validate the SE is indeed the authorized holder of the telephone number and vesper token at the time the presentation is required and ties the SE to the STIR eco-system a STIR certificates policy for use in communications. 
    " name="description">
<meta content="xml2rfc 3.23.2" name="generator">
<meta content="telephone number" name="keyword">
<meta content="vetting" name="keyword">
<meta content="KYC" name="keyword">
<meta content="draft-wendt-stir-vesper-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.23.2
    Python 3.12.7
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.3.6
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-wendt-stir-vesper.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">vesper</td>
<td class="right">October 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wendt &amp; Sliwa</td>
<td class="center">Expires 24 April 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Secure Telephone Identity Revisited</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-wendt-stir-vesper-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-10-21" class="published">21 October 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-04-24">24 April 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Wendt</div>
<div class="org">Somos, Inc.</div>
</div>
<div class="author">
      <div class="author-name">R. Sliwa</div>
<div class="org">Somos, Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">VESPER PASSporT and Identity Tokens - VErifiable STI Personas</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document extends the STIR architecture by defining a Personal Assertion Token (PASSporT) with a type of "vesper" (VErifiable Sti PERsona) and specifies the use of PASSporTs as a JSON Web Tokens (JWT) and Selective Disclosure JWT (SD-JWT) for representing verifiable claims related to a persona (a person or business entity) associated with a Secure Telephone Identity (STI). This set of extensible claims can include verifiable information such as the assignment of a telephone number, the output of a Know Your Customer (KYC) or Know Your Business (KYB) type of vetting process, Rich Call Data (RCD) or claims of consent provided to the telephone number holder. The architecture, dependencies, and process flow of Vesper includes logical roles that represent certain responsibilities for establishing a secure telephone identity. These roles represent the basis for trusted relationships to information that is being claimed and who is validating and taking responsibility for the accuracy of that information. These roles begin with a Subject Entity (SE) that is the end entity that intended to be represented by the STI telephone number identifier. A Vetting Claim Agent (VCA) establishes the Subject Entity as a vetted entity after performing the initial vetting and existence as a entity that fulfills the criteria and policies of the ecosystem to be associated with an STI. A Notary Agent (NA) is a neutral role that maintains a graph of relationships among all roles, claims, and identities, but importantly, for protecting privacy, doesn't hold any claim information other than the recording of claim events to the STI telephone number. The NA records these claim event transactions with a corresponding transparency log that generates verifiable receipts to "notarize" the recording of these relationships and claims being established. Privacy is enabled in this Notary role because the submitters have the option of submitting hashes of claims to protect information, or may usefully want to publicly declare their association to a claim to allow the public monitoring to avoid duplicate, mistaken or negligent claims which can be identified before illegitimate usage in the eco-system can occur. Other Claim Agents are defined producing claims in the form of SD-JWT + receipts from the NA. There are multiple claim agent types with corresponding extensible claim definitions with key value pairs that can be required or optionally included. These SD-JWT + receipt claim objects are then collected by the SE into a digital wallet that it can then use for selective disclosure presentation and incorporate into a "vesper" PASSporT signed by the a delegate certificate associated with STI telephone number to validate the SE is indeed the authorized holder of the telephone number and vesper token at the time the presentation is required and ties the SE to the STIR eco-system a STIR certificates policy for use in communications.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://appliedbits.github.io/draft-wendt-stir-vesper/draft-wendt-stir-vesper.html">https://appliedbits.github.io/draft-wendt-stir-vesper/draft-wendt-stir-vesper.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-wendt-stir-vesper/">https://datatracker.ietf.org/doc/draft-wendt-stir-vesper/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Secure Telephone Identity Revisited Working Group mailing list (<span><a href="mailto:stir@ietf.org">mailto:stir@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/stir/">https://mailarchive.ietf.org/arch/browse/stir/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/stir/">https://www.ietf.org/mailman/listinfo/stir/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/appliedbits/draft-wendt-stir-vesper">https://github.com/appliedbits/draft-wendt-stir-vesper</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 24 April 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-vesper-architectural-overvi" class="internal xref">Vesper Architectural Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-introduction-to-vesper-toke" class="internal xref">Introduction to Vesper Tokens and Trust Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-key-features-of-vesper-toke" class="internal xref">Key Features of Vesper Tokens</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-roles-and-responsibilities-" class="internal xref">Roles and Responsibilities in the Vesper Ecosystem</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-claim-agent-roles" class="internal xref">Claim Agent Roles</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-claim-agent-responsibilitie" class="internal xref">Claim Agent Responsibilities</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-notary-agent-claim-graph-an" class="internal xref">Notary Agent - Claim Graph and Transparency Log</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-claim-graph" class="internal xref">Claim Graph</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="auto internal xref">4.3.2</a>.  <a href="#name-transparency-log" class="internal xref">Transparency Log</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a href="#section-4.3.3" class="auto internal xref">4.3.3</a>.  <a href="#name-claim-agents-and-claim-info" class="internal xref">Claim Agents and Claim Information Privacy</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-transport-and-presentation-" class="internal xref">Transport and Presentation - Vesper PASSporT</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-vesper-passport-and-vesper-" class="internal xref">Vesper PASSporT and Vesper Claim Verification and Proof of Authenticity</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a href="#section-4.5.1" class="auto internal xref">4.5.1</a>.  <a href="#name-as-verification" class="internal xref">AS Verification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.2">
                    <p id="section-toc.1-1.4.2.5.2.2.1"><a href="#section-4.5.2" class="auto internal xref">4.5.2</a>.  <a href="#name-vs-verification" class="internal xref">VS Verification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.3">
                    <p id="section-toc.1-1.4.2.5.2.3.1"><a href="#section-4.5.3" class="auto internal xref">4.5.3</a>.  <a href="#name-verification-and-relying-pa" class="internal xref">Verification and Relying Party Actions</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-vesper-achitecture" class="internal xref">Vesper Achitecture</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-high-level-flow" class="internal xref">High Level Flow</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-notary-agent-flows" class="internal xref">Notary Agent Flows</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-claim-graph-2" class="internal xref">Claim Graph</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="auto internal xref">6.2.2</a>.  <a href="#name-merkle-tree-and-transparenc" class="internal xref">Merkle Tree and Transparency Log</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="auto internal xref">6.2.3</a>.  <a href="#name-vetting-claim-agent-vca-pro" class="internal xref">Vetting Claim Agent (VCA) Provisions New Subject Entity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.4">
                    <p id="section-toc.1-1.6.2.2.2.4.1"><a href="#section-6.2.4" class="auto internal xref">6.2.4</a>.  <a href="#name-vetting-claim-agent-adds-ky" class="internal xref">Vetting Claim Agent Adds KYC Claims</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.5">
                    <p id="section-toc.1-1.6.2.2.2.5.1"><a href="#section-6.2.5" class="auto internal xref">6.2.5</a>.  <a href="#name-rtu-claim-agent-adds-teleph" class="internal xref">RTU Claim Agent Adds Telephone Number (TN) Assignment</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.6">
                    <p id="section-toc.1-1.6.2.2.2.6.1"><a href="#section-6.2.6" class="auto internal xref">6.2.6</a>.  <a href="#name-claim-agent-adds-rich-call-" class="internal xref">Claim Agent Adds Rich Call Data (RCD)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.7">
                    <p id="section-toc.1-1.6.2.2.2.7.1"><a href="#section-6.2.7" class="auto internal xref">6.2.7</a>.  <a href="#name-using-sd-jwt-for-trust" class="internal xref">Using SD-JWT for Trust</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-notary-agent-api" class="internal xref">Notary Agent API</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="auto internal xref">6.3.1</a>.  <a href="#name-create-subject-entity-se-ap" class="internal xref">Create Subject Entity (SE) API</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="auto internal xref">6.3.2</a>.  <a href="#name-add-kyc-claims-api" class="internal xref">Add KYC Claims API</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.3">
                    <p id="section-toc.1-1.6.2.3.2.3.1"><a href="#section-6.3.3" class="auto internal xref">6.3.3</a>.  <a href="#name-add-telephone-number-tn-ass" class="internal xref">Add Telephone Number (TN) Assignment API</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.4">
                    <p id="section-toc.1-1.6.2.3.2.4.1"><a href="#section-6.3.4" class="auto internal xref">6.3.4</a>.  <a href="#name-add-rich-call-data-rcd-clai" class="internal xref">Add Rich Call Data (RCD) Claims API</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.5">
                    <p id="section-toc.1-1.6.2.3.2.5.1"><a href="#section-6.3.5" class="auto internal xref">6.3.5</a>.  <a href="#name-verify-notary-receipt-api" class="internal xref">Verify Notary Receipt API</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.6">
                    <p id="section-toc.1-1.6.2.3.2.6.1"><a href="#section-6.3.6" class="auto internal xref">6.3.6</a>.  <a href="#name-retrieve-entity-history-api" class="internal xref">Retrieve Entity History API</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-vesper-wallet-flows" class="internal xref">Vesper Wallet Flows</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a href="#section-6.4.1" class="auto internal xref">6.4.1</a>.  <a href="#name-vesper-wallet-key-pair-gene" class="internal xref">Vesper Wallet Key Pair Generation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.2">
                    <p id="section-toc.1-1.6.2.4.2.2.1"><a href="#section-6.4.2" class="auto internal xref">6.4.2</a>.  <a href="#name-storage-of-sd-jwts-and-nota" class="internal xref">Storage of SD-JWTs and Notary Receipts</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.3">
                    <p id="section-toc.1-1.6.2.4.2.3.1"><a href="#section-6.4.3" class="auto internal xref">6.4.3</a>.  <a href="#name-building-the-vesper-token" class="internal xref">Building the Vesper Token</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.4">
                    <p id="section-toc.1-1.6.2.4.2.4.1"><a href="#section-6.4.4" class="auto internal xref">6.4.4</a>.  <a href="#name-signing-the-vesper-passport" class="internal xref">Signing the Vesper PASSporT</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.5">
                    <p id="section-toc.1-1.6.2.4.2.5.1"><a href="#section-6.4.5" class="auto internal xref">6.4.5</a>.  <a href="#name-passing-the-vesper-passport" class="internal xref">Passing the Vesper PASSporT to the Authentication Service (AS)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.6">
                    <p id="section-toc.1-1.6.2.4.2.6.1"><a href="#section-6.4.6" class="auto internal xref">6.4.6</a>.  <a href="#name-verification-of-vesper-pass" class="internal xref">Verification of Vesper PASSporT by VS</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-the-vesper-passport" class="internal xref">The "vesper" PASSporT</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-compact-form-and-other-repr" class="internal xref">Compact Form and Other Representations of Vesper Information</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-vesper-claims" class="internal xref">Vesper Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-vesper-claim-sd-jwt-selecti" class="internal xref">Vesper Claim SD-JWT (Selective Disclosure JSON Web Tokens)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-sd-jwt-and-disclosures" class="internal xref">SD-JWT and Disclosures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-vesper-claim-sd-jwt-data-fo" class="internal xref">Vesper Claim SD-JWT Data Formats</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-claim-agents" class="internal xref">Claim Agents</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-claim-agent-types-and-claim" class="internal xref">Claim Agent Types and Claim Values</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#section-9.1.1" class="auto internal xref">9.1.1</a>.  <a href="#name-vetting-claim-agent-vca" class="internal xref">Vetting Claim Agent - "vca"</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#section-9.1.2" class="auto internal xref">9.1.2</a>.  <a href="#name-right-to-use-claim-agent-rt" class="internal xref">Right to Use Claim Agent - "rtuca"</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.3">
                    <p id="section-toc.1-1.9.2.1.2.3.1"><a href="#section-9.1.3" class="auto internal xref">9.1.3</a>.  <a href="#name-rich-call-data-claim-agent-" class="internal xref">Rich Call Data Claim Agent - "rcdca"</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.4">
                    <p id="section-toc.1-1.9.2.1.2.4.1"><a href="#section-9.1.4" class="auto internal xref">9.1.4</a>.  <a href="#name-consent-claim-agent-cca" class="internal xref">Consent Claim Agent - "cca"</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-vesper-passport-token-as-a-" class="internal xref">Vesper PASSporT Token as a wrapper for Multiple Vesper Claims Presentation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-structure-of-multiple-vespe" class="internal xref">Structure of multiple Vesper Claim Presentation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-preventing-replay-attacks" class="internal xref">Preventing Replay Attacks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-mitigation-strategy-jwt-id-" class="internal xref">Mitigation Strategy - JWT ID (JTI) Claim</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-example-issuance" class="internal xref">Example Issuance</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-json-web-token-claims" class="internal xref">JSON Web Token claims</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-passport-types" class="internal xref">PASSporT Types</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Secure Telephone Identity (STI) architecture fundamentally defined by STI certificates in <span>[<a href="#RFC8226" class="cite xref">RFC8226</a>]</span>, PASSporTs in <span>[<a href="#RFC8225" class="cite xref">RFC8225</a>]</span>, and the SIP Identity header field <span>[<a href="#RFC8224" class="cite xref">RFC8224</a>]</span> describe a set of constructs and protocols for the use of tokens and digital signatures to protect the integrity and provide non-repudiation of information as part of a communications session most notably the associated telephone numbers. This document extends that architecture to address the association of a telephone number to a persona (e.g. a person or business entity) given responsibility for the right to use that telephone number. Recently, the illegitimate use of telephone numbers by unauthorized parties and the associated fraudulent activity associated with those communications has generally eroded trust in communications systems. Further, basic reliance on the trustworthiness of the signer alone at the time of the communications has proven to require people to perform time-consuming work in the form of after-the-fact investigation and enforcement activities, but to date has proven mostly ineffective because the true initiator of the communications is generally not directly associated to that communications. Other industries like the financial industry, have adopted well-known successful practices of Know Your Customer (KYC) or Know Your Business (KYB) that apply different vetting practices of an end entity. This document focuses on a set of roles and the protocol interactions between those roles that can properly establish mechanisms for trusted transactions, an explicit set of processes and verifiable actions that should be followed to establish the representation of claims about the persona that are vetted before any communications can be initiated. These claim information establishment transactions are recorded or notarized with authorized or responsible parties while also importantly enabling privacy controls around the disclosure of the persona information. Transparency logging of relationships and transaction events for claim information is also required to further establish trust with optional public disclosure to guarantee uniqueness when desired. The explicit connection between a persona with a telephone number and the responsibilities associated with its use is a critical step towards building the use of telephone numbers and ability to enforce usage policies that allow privacy but discourage taking advantage of those properties with the intent to impersonate for illegitimate reasons. Ultimately, the establishment of secure telephone identity with reasonable policies for establishing those identities will result in greater trusted relationships between parties involved in a set of communications.<a href="#section-1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-3">
      <h2 id="name-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-3-1">This document describes the establishment of a "vesper" (VErifiable Sti PERsona) PASSporT type with corresponding "vesper" claims which are signed claims using a three party trust model represented by SD-JWTs <span>[<a href="#I-D.ietf-oauth-selective-disclosure-jwt" class="cite xref">I-D.ietf-oauth-selective-disclosure-jwt</a>]</span> and enabled with transparency logs and corresponding receipts that enable either a privacy protecting hash disclosure or a public disclosure that allows for verifiable trust to ensure that those entities that validate claim information are legitimate actors in the ecosystem. Additionally, the vesper token in conjunction with the claims architecture provides mechanisms that enable a persona to selectively disclose any personally identifying information to other parties, while at the same time making this information available in special limited cases, for example, based on enforcement actions, required for legitimately authorized legal or regulatory activity.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">In the current state of digital identities, the unique identifier used to identify a persona is obviously a critical component of digital protocols that need to identify the persona. However, just as important, is the ability to verify the existence of a real-world persona to that identifier as the responsible party behind that identifier. The telephone number as an identifier and as part of a set of traditional communications services offered around the world has been facing a challenge of illegitimate fraud based on the lack of a formal framework for the explicit association of a set of communications to a directly responsible party. The use of "spoofing" of telephone numbers, a practice of the use of telephone numbers by not directly authorized parties, while having very legitimate use-cases, has been exploited by actors of fraudulent intent to either impersonate the legitimate party, or simply obfuscate the actual party behind the call. Fraud and illegitimate activity has proliferated based on the loose connection of telephone numbers to responsible parties.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The vetting process for entities involves verifying their identity and legitimacy, typically through KYC and KYB vetting procedures. This document proposes a standardized method for representing the results of these vetting procedures using Selective Disclosure JWT (SD-JWT). This document does not address how the KYC/KYB should be performed or policies around what documents or processes should be used. Rather the goal of this document is to create a standardized identifier for the Subject Entities (SE) to present that they are who they claim to be and associated verified claims.<a href="#section-3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="vesper-architectural-overview">
<section id="section-4">
      <h2 id="name-vesper-architectural-overvi">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-vesper-architectural-overvi" class="section-name selfRef">Vesper Architectural Overview</a>
      </h2>
<div id="introduction-to-vesper-tokens-and-trust-model">
<section id="section-4.1">
        <h3 id="name-introduction-to-vesper-toke">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-introduction-to-vesper-toke" class="section-name selfRef">Introduction to Vesper Tokens and Trust Model</a>
        </h3>
<p id="section-4.1-1">The use of Vesper Tokens in communications will allow for a trust model enabled by a three-party trust system based on an agreed set of vetting policies with a set of privacy enabled features to allow for selective disclosure for communications. This trust framework requires establishment of policies for participation of end entities and those that vet and validate information about those end entities.  This information includes validated information about the entities themselves, the authorized right to use of a telephone number with the ability to support use-cases that validate all claims about the end entity or might only require anonymity and simply only validate the telephone number but the entity behind that telephone number exists and is real. The representation of roles that facilitate the trust of the association of a telephone number and other entity information is in the form of claims.  This document defines the role of those that validate and create claims against an entity are called Claim Agents that create specific claim types that have specified associated standard mandatory and optional key values.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div id="key-features-of-vesper-tokens">
<section id="section-4.1.1">
          <h4 id="name-key-features-of-vesper-toke">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-key-features-of-vesper-toke" class="section-name selfRef">Key Features of Vesper Tokens</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-4.1.1-1.1">
              <p id="section-4.1.1-1.1.1">Selective Disclosure: In order to protect privacy or in the mode of exposing only the required level of detail of information in a zero knowledge proof type of disclosure, entities can choose to convey a transaction specific presentation of information to different relying parties.<a href="#section-4.1.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.1-1.2">
              <p id="section-4.1.1-1.2.1">Right to Use (RTU) of Telephone Numbers: Vesper tokens can ensure that only those entities that are assigned telephone numbers can use or delegate the use of those telephone numbers with the control of an explicit token.<a href="#section-4.1.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.1-1.3">
              <p id="section-4.1.1-1.3.1">Flexible Use Cases: Vesper tokens can be used for KYC/KYB vetting, Rich Call Data (RCD), and consent claims.  New use-cases can be and are anticipated to be defined in the future.<a href="#section-4.1.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="roles-and-responsibilities-in-the-vesper-ecosystem">
<section id="section-4.2">
        <h3 id="name-roles-and-responsibilities-">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-roles-and-responsibilities-" class="section-name selfRef">Roles and Responsibilities in the Vesper Ecosystem</a>
        </h3>
<p id="section-4.2-1">The trust framework defines several roles that facilitate claims about telephone numbers and other entity information. The first two primary roles are defined as Claim Agents and Subject Entities (SE).  The Claim Agents are responsible for making either authoritative or validated claims about a Subject Entity (SE). The Claim Agent in turn collects these validated claims to present to other entities that they want to trust that information.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div id="claim-agent-roles">
<section id="section-4.2.1">
          <h4 id="name-claim-agent-roles">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-claim-agent-roles" class="section-name selfRef">Claim Agent Roles</a>
          </h4>
<p id="section-4.2.1-1">The following are the claim agent roles defined in this document.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-2.1">
              <p id="section-4.2.1-2.1.1">Vetting Claim Agent (VCA): Handles KYC/KYB vetting and establishes the SE as an identifiable entity in the ecosystem.<a href="#section-4.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-2.2">
              <p id="section-4.2.1-2.2.1">Right To Use Claim Agent (RTUCA): Handles the vetting of telephone numbers assigned to the SE.<a href="#section-4.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-2.3">
              <p id="section-4.2.1-2.3.1">Rich Call Data Claim Agent (RCDCA): Provides vetting and validation of Rich Call Data claims for the SE.<a href="#section-4.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-2.4">
              <p id="section-4.2.1-2.4.1">Consent Claim Agent (CCA): Handles consent claims for allowing SE's to call or message specific telephone numbers.<a href="#section-4.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.1-3">Further details about these roles and the specific claims and key value attributes of the claims validated by the Claim Agents are defined later in the document. Future Claim Agent roles are anticipated to be defined by future documents.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="claim-agent-responsibilities">
<section id="section-4.2.2">
          <h4 id="name-claim-agent-responsibilitie">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-claim-agent-responsibilitie" class="section-name selfRef">Claim Agent Responsibilities</a>
          </h4>
<p id="section-4.2.2-1">Claim Agents validate and register claims about Subject Entities. Claim Agents are registered and uniquely identified in the Vesper Framework via the Notary Agent (NA). The NA maintains a common append-only Claim Graph for claim events each Claim Agent makes regarding Subject Entities and issues transparency receipts for the recording and notarizing each claim event. The details of this are described later in the document. Claim Agents ultimately issue SD-JWT tokens containing the validated claim key values to the Subject Entities (SE) vetted by the Claim Agent. The Claim Agent asserts the validated claims in a signed SD-JWT which, combined with a transparency receipt from the NA, are delivered to the SE which holds these SD-JWT tokens + receipts (vesper claims) in a Vesper Wallet (VW). The Vesper Wallet can then be used for specific selective disclosure of information presented to relying party.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="notary-agent-claim-graph-and-transparency-log">
<section id="section-4.3">
        <h3 id="name-notary-agent-claim-graph-an">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-notary-agent-claim-graph-an" class="section-name selfRef">Notary Agent - Claim Graph and Transparency Log</a>
        </h3>
<p id="section-4.3-1">In the Vesper ecosystem, Claim Agents issue claims about the Subject Entity. To ensure trust and accountability, all interactions between Claim Agents and Subject Entities are registered and notarized by the Notary Agent. The NE internally operates two key dependent services: the Claim Graph and the Transparency Log. Importantly, these notarizations can be privacy protected by storing hashes of the claim JSON objects or can be used for public transparency of the claim object contents so they can be monitored for mis-claims made by other non-authorized Subject Entities and handled through a resolution process that is eco-system specific. This resolution process is not in-scope for this document, but is likely coordinated via the Notary Agent through establishment of contacts and communications to the Claim Agents.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<div id="claim-graph">
<section id="section-4.3.1">
          <h4 id="name-claim-graph">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-claim-graph" class="section-name selfRef">Claim Graph</a>
          </h4>
<p id="section-4.3.1-1">The Claim Graph is an append-only registry of the recording of claim validation events made by a Claim Agent responsible vetting the claims related to an SE. Each claim validation event issued by a Claim Agent is added to this graph as a node, with relationships represented as edges between entities.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-2">Every time a new claim is added or updated in the Claim Graph, the service creates a graph snapshot hash of the graph, thereby uniquely representing a current snapshot of the graph. This hash serves as a unique cryptographic representation of the claim graph state at that moment in time. The hashed snapshot is then recorded in the Transparency Log, ensuring that the claims history is transparent, immutable, and auditable. By using cryptographic hashing, the Claim Graph remains secure, and any changes to the claims can be traced and verified.<a href="#section-4.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transparency-log">
<section id="section-4.3.2">
          <h4 id="name-transparency-log">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-transparency-log" class="section-name selfRef">Transparency Log</a>
          </h4>
<p id="section-4.3.2-1">The Transparency Log is part of the NA's services and plays a crucial role in ensuring that all claims made by Claim Agents are trustworthy. It allows claims to be verifiable across different agents using cryptographic methods. Once a claim is hashed by the Claim Graph, it is added to the log, making it accessible for verification.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2-2">Receipt Issuance:
After each claim is recorded, the NA issues a Receipt to submitting Claim Agent, ultimately sent to the SE to pair with the claim token. This receipt includes proof that the claim has been added to the Transparency Log. The SE can then present this receipt alongside claims in SD-JWT as proof that the claims have been transparently logged.<a href="#section-4.3.2-2" class="pilcrow">¶</a></p>
<p id="section-4.3.2-3">Interaction with Claim Agents:
Claim Agents do not directly modify the Claim Graph. Instead, they interact with NA via its APIs, which serve as a wrapper around both the Claim Graph and Transparency Log. This ensures that claims are properly registered, hashed, and logged without direct manipulation of the underlying data structures.<a href="#section-4.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="claim-agents-and-claim-information-privacy">
<section id="section-4.3.3">
          <h4 id="name-claim-agents-and-claim-info">
<a href="#section-4.3.3" class="section-number selfRef">4.3.3. </a><a href="#name-claim-agents-and-claim-info" class="section-name selfRef">Claim Agents and Claim Information Privacy</a>
          </h4>
<p id="section-4.3.3-1">An important feature of this system is its ability to protect the privacy of the SE. Claim Agents are not required to store any private data in the Claim Graph. Instead, they store only the hash of the data, which acts as a representation of the claim without exposing sensitive information.<a href="#section-4.3.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3.3-2">Public vs. Private Data:
If the SE has public data (e.g., a business name or logo that is inherently public or the SE has incentive to publicly declare that information with no privacy implications), it can be added to the Claim Graph for greater visibility, perhaps with more trust implied because of the public scrutiny over the uniqueness of that information. This public declaration allows other Claim Agents or other interested ecosystem actors to detect fraud or suspicious activity. However, private data should always remain hashed and protected unless specifically required for disclosure by the SE.<a href="#section-4.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="transport-and-presentation-vesper-passport">
<section id="section-4.4">
        <h3 id="name-transport-and-presentation-">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-transport-and-presentation-" class="section-name selfRef">Transport and Presentation - Vesper PASSporT</a>
        </h3>
<p id="section-4.4-1">The SE can use claims stored in their Vesper Wallet to generate a Vesper PASSporT, which includes SD-JWTs and associated NA Transparency Receipts. This Vesper PASSporT is signed by a delegate certificate and attached to communications, such as in the case of STIR.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">Vesper PASSporT Flow:
1. Using Vesper Wallet, SE determines through selective disclosure the presentation required for a particular set of communications (e.g. a call or message to particular destination verifier) which creates a 'vesper' PASSporT containing 'vesper' claims including corresponding SD-JWT + receipts of claims the SE desires to be presented.
2. Vesper PASSporT is signed by a delegate certificate associated with the telephone number the SE has the right to use, representing its legitimate participation in the STIR ecosystem set of communications delegated by the TNSP or RespOrg that assigned the telephone number resource.
3. The signed PASSporT is attached to a SIP identity header for verification by the destination party.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="vesper-passport-and-vesper-claim-verification-and-proof-of-authenticity">
<section id="section-4.5">
        <h3 id="name-vesper-passport-and-vesper-">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-vesper-passport-and-vesper-" class="section-name selfRef">Vesper PASSporT and Vesper Claim Verification and Proof of Authenticity</a>
        </h3>
<p id="section-4.5-1">The Vesper framework generally allows the relying party and verification service to validate both the PASSporT specific communication association (i.e. the "orig", "dest", and "iat" PASSporT claims specific to that communications) as well as the claims and the identity of who issued each of the 'vesper' claims with the appropriate amount of disclosure or presentation required for the verifier.  This framework ties both trust of the claims to those Claim Agents that validate claims. Via STIR and the use of STIR certificates and PASSporTs the Vesper PASSporT ties the valid use of a STIR certificates within an eco-system governed by STIR certificate policies to a certificate with a TNAuthList containing the relevant telephone number associated with the STI and use of certificate delegation to the end entity associated with that telephone number.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<div id="as-verification">
<section id="section-4.5.1">
          <h4 id="name-as-verification">
<a href="#section-4.5.1" class="section-number selfRef">4.5.1. </a><a href="#name-as-verification" class="section-name selfRef">AS Verification</a>
          </h4>
<p id="section-4.5.1-1">As the Vesper PASSporT is constructed and signed for a specific destination party, the AS will be provided with a set of 'vesper' claims which <span class="bcp14">MAY</span> be verified by the AS. This is optionally supported by Authentication Services that want to validate the Vesper Token for its verifiability or perhaps its conformance to policies. More generally, whether the AS chooses to verify the vesper claims, any issues with the verifiability of the Vesper PASSporT should be discovered by the relying party doing verification.<a href="#section-4.5.1-1" class="pilcrow">¶</a></p>
<p id="section-4.5.1-2">Signature Verification:
The AS ensures that the Vesper Token's signature is valid based on the public key provided.<a href="#section-4.5.1-2" class="pilcrow">¶</a></p>
<p id="section-4.5.1-3">Action on Failure:
If the Vesper Presentation (the wrapped SD-JWTs and Receipts) is invalid, the AS will stop processing the request, ensuring that the call will not proceed and <span class="bcp14">MAY</span> notify caller of the validation failure via STIR error codes (i.e. 4xx) defined in <span>[<a href="#RFC8224" class="cite xref">RFC8224</a>]</span>.<a href="#section-4.5.1-3" class="pilcrow">¶</a></p>
<p id="section-4.5.1-4">The Vesper Token contains SD-JWTs (with claims) and associated NA Receipts, and its signature is signed by a delegate certificate delegated by the authorized entity in the STIR ecosystem.<a href="#section-4.5.1-4" class="pilcrow">¶</a></p>
<p id="section-4.5.1-5">NOTE: The relationship between Vesper Wallet that creates Vesper Token and the AS in practice will be likely a trusted relationship and therefore AS may chose to trust the Vesper Token without further verification.<a href="#section-4.5.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="vs-verification">
<section id="section-4.5.2">
          <h4 id="name-vs-verification">
<a href="#section-4.5.2" class="section-number selfRef">4.5.2. </a><a href="#name-vs-verification" class="section-name selfRef">VS Verification</a>
          </h4>
<p id="section-4.5.2-1">Once the Vesper Token reaches the Verification Service (VS), the token undergoes further checks to confirm its authenticity and integrity.<a href="#section-4.5.2-1" class="pilcrow">¶</a></p>
<p id="section-4.5.2-2">Payload Verification:
The first step for VS is to verify the Vesper Token's signature. This ensures that the token has not been tampered with during transit. Any modification to the payload will invalidate the signature, and the VS will fail the verification and <span class="bcp14">MAY</span> fail the communication.<a href="#section-4.5.2-2" class="pilcrow">¶</a></p>
<p id="section-4.5.2-3">SD-JWT Claim Verification:
After validating the Vesper Token, the VS looks up each of the SD-JWTs associated with the claim types included in the Vesper Token. Each SD-JWT contains claims made by the Claim Agents and the signature of the SD-JWT must be verified individually by the VS, using the Public Key Verification described below. If the Vesper Presentation (the wrapped SD-JWTs and Receipts) are invalid, the VS will stop processing the request, ensuring that the call will not proceed and <span class="bcp14">MUST</span> notify the caller via STIR error codes (i.e. 4xx) defined in <span>[<a href="#RFC8224" class="cite xref">RFC8224</a>]</span>.<a href="#section-4.5.2-3" class="pilcrow">¶</a></p>
<p id="section-4.5.2-4">Public Key Verification:
The VS uses the public key provided as a JSON Web Key (JWK) to verify the signatures of the SD-JWTs. Each SD-JWT's signature ensures that the claim data has not been altered and that the entity issuing the claim is legitimate.<a href="#section-4.5.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verification-and-relying-party-actions">
<section id="section-4.5.3">
          <h4 id="name-verification-and-relying-pa">
<a href="#section-4.5.3" class="section-number selfRef">4.5.3. </a><a href="#name-verification-and-relying-pa" class="section-name selfRef">Verification and Relying Party Actions</a>
          </h4>
<p id="section-4.5.3-1">Once the VS of the relying party completes verification procedures, it can reliably depend on the fact that the vesper presentation of the token or PASSporT has been signed with non-repudation by the subject entity and that the subject entity has used the services of the claim agents that have issued and signed each of the 'vesper' claims contained in the parent Vesper token.  In addition, with the NA transparency receipts the relying party can also trust that a claim was made by authorized participants in the eco-system.  The public declaration of claim information can also be verified for cases where that may be an important criteria for the trustability of that information (e.g. the corporate logo or name of a business entity).<a href="#section-4.5.3-1" class="pilcrow">¶</a></p>
<p id="section-4.5.3-2">Traceability:
The successful validation of the Vesper Token and its claims allows the VS to trust that the caller is who they claim to be. Because the identity of the responsible claim agents that validated the information about the SE, and the identity of SE itself are transparent, if there is any question about the validity of information comes into question, the relying party or other ecosystem or law enforcement entity has a direct path for investigating and questioning the claim agents and the subject entity themselves. This direct accountability and clear lines of responsibility is a critical part of maintaining the trust in the ecosystem which the Vesper framework is very much intended to represent. A robust set of policies about the characteristics and definitions of the content of the claims is beyond the scope of this document, but should also be part of a specific governance or jurisdictional implementation of the Vesper framework.<a href="#section-4.5.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-5">
      <h2 id="name-terminology">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-5-1">Claim Agent: An entity that is either authorized by or trusted within the eco-system to make claims of persona-related information and to issue verifiable selectively disclosable tokens containing the vetted claim information. A Claim Agent can be a trusted third party or a service provider that performs the vetting of persona-related information. Claim Agent is a role category where there are a defined a set of specific claim agent types with associated claim attribute key values that are either required or optional by specification.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Vetting Claim Agent (VCA): The Claim Agent entity that initiates and establishes a Subject Entity into the eco-system. Its role is to vet a set of claims that identify the persona as an entity in the real world; claims that identify physical address, business identifiers, contact information and other real-world identifying information. Generally, this information is not disclosed as part of a typical communications transaction, although nothing prevents it from being disclosed if the SE so wishes. However, it's an important set of information to establish the existence and legal standing of a persona. This information is also relevant to a potential legal or policy enforcement action that may be required based on alleged legal or policy violations (which is something the VCA would be a responsible party to facilitate).<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Right to Use Claim Agent (RTUCA): The Claim Agent entity that generally represents an authorized provider of telephone numbers for direct assignment to an SE.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Rich Call Data Claim Agent (RCDCA): The Claim Agent entity that is responsible for vetting the Rich Call Data claims and validating they represent the Subject Entity and conform to any relevant content policies for any relying eco-systems a Vesper PASSporT token may be used.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">Consent Claim Agent (CCA): The Claim Agent entity that is responsible for handling and vetting consent claims associated with different called party destination numbers for calls initiated by the calling party's originating telephone number. These could include consent to call/message for specific telephone numbers or consent to calls of various types of callers as defined in <span>[<a href="#I-D.ietf-sipcore-callinfo-spam" class="cite xref">I-D.ietf-sipcore-callinfo-spam</a>]</span>, or consent to call with robocalling, AI-enabled, or chatbot types of automated calling or messaging.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">Subject Entity (SE): An entity that is vetted by a Claims Agent and holds the verifiable token containing the vetted information. The Claims Agent can be a person or a business entity.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">Notary Agent (NA): The entity that maintains the Claim Graph and Transparency Log. The Notary Agent is responsible for ensuring the integrity and transparency of the claims made by the Claim Agents. The Notary Agent issues receipts for each claim event, which are used to verify the authenticity of the claims. The Notary Agent role is likely performed by a neutral party in the ecosystem.<a href="#section-5-7" class="pilcrow">¶</a></p>
<p id="section-5-8">Vesper PASSporT or Token: A verifiable token that follows the definition of PASSporT in <span>[<a href="#RFC8225" class="cite xref">RFC8225</a>]</span> created by a Subject Entity containing the presentation of disclosable claims for a specific relying party destination. The Vesper Token is represented as a JSON Web Token (JWT) PASSporT that contains "vesper" claims that are Selective Disclosure JWT (SD-JWT) + transparency receipts generated by the Notary Agent.<a href="#section-5-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="vesper-achitecture">
<section id="section-6">
      <h2 id="name-vesper-achitecture">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-vesper-achitecture" class="section-name selfRef">Vesper Achitecture</a>
      </h2>
<p id="section-6-1">The Vesper architecture is designed around the concept of creating a secure Persona for each Subject Entity (SE) within an eco-system. This Persona is characterized by its verifiability, privacy-preserving nature, tamper resistance, and auditability. It enables SEs to interact with other entities confidently, knowing that their claims and credentials are cryptographically secured and independently verifiable. The architecture ensures that sensitive information is protected while still allowing for seamless, trust-based exchanges between parties.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The Vesper architecture employs the following key entities to manage and maintain these secure Personas:<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Subject Entities (SEs): The organizations whose claims are being issued and verified within the system.
Claim Agents: Entities that facilitate the exchange of claims between SEs and verify the validity of these claims.
Notary Agent (NA): A central authority that ensures the integrity, transparency, and auditability of interactions by maintaining a verifiable log of claims and transactions, ensuring tamper-proof records.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="high-level-flow">
<section id="section-6.1">
        <h3 id="name-high-level-flow">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-high-level-flow" class="section-name selfRef">High Level Flow</a>
        </h3>
<p id="section-6.1-1">The Vesper framework follows a high-level flow that involves the provisioning of the Subject Entity and the subsequent management of claims through different Claim Agents. This section outlines the primary interactions between the SE, the Vetting Claim Agent (VCA), the Right To Use Claim Agent (RTUCA), and potentially other Claim Agent services. The flow ends with the SE generating a Vesper PASSporT presentation in order to, for example, use with a STIR Authentication Service while making a phone call. This Vesper PASSporT presentation will include the relevant claims and selected disclosures intended for that call for verification by the Verification Service.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">This overview provides the context for more detailed explanations in subsequent sections.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">High-Level Flow:<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1-4">
<li id="section-6.1-4.1">
            <p id="section-6.1-4.1.1">VCA Provisions SE:<a href="#section-6.1-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-4.1.2.1">
                <p id="section-6.1-4.1.2.1.1">The SE as a business or person entity is first vetted by the VCA, which performs KYC types of checks.<a href="#section-6.1-4.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-4.1.2.2">
                <p id="section-6.1-4.1.2.2.1">Once the SE is validated, the event is captured in the Notary Agent (NA) via the Claim Graph (CG) and Transparency Service (TS).<a href="#section-6.1-4.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-4.1.2.3">
                <p id="section-6.1-4.1.2.3.1">The SE receives an SD-JWT containing the KYC claims and a Transparency Receipt, which are stored in the Vesper Wallet (VW).<a href="#section-6.1-4.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-6.1-4.2">
            <p id="section-6.1-4.2.1">SE Contacts RTUCA corresponding to their Telephone Number Assignment:<a href="#section-6.1-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-4.2.2.1">
                <p id="section-6.1-4.2.2.1.1">The SE interacts with the Right To Use Claim Agent (RTUCA) to obtain telephone numbers.<a href="#section-6.1-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-4.2.2.2">
                <p id="section-6.1-4.2.2.2.1">The RTUCA claims and validates one or more TNs and records the event in the NA, returning an SD-JWT with the assigned TNs and a corresponding Transparency Receipt.<a href="#section-6.1-4.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-4.2.2.3">
                <p id="section-6.1-4.2.2.3.1">The SE stores this data in the VW.<a href="#section-6.1-4.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-6.1-4.3">
            <p id="section-6.1-4.3.1">SE Contacts RCD Claim Agent for Rich Call Data:<a href="#section-6.1-4.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-4.3.2.1">
                <p id="section-6.1-4.3.2.1.1">The SE contacts the Rich Call Data Claim Agent to enrich the telephone call data.<a href="#section-6.1-4.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-4.3.2.2">
                <p id="section-6.1-4.3.2.2.1">The RCD Claim Agent verifies the SE's claims and adds Rich Call Data to the CG.<a href="#section-6.1-4.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-4.3.2.3">
                <p id="section-6.1-4.3.2.3.1">An SD-JWT containing the new claims and a Transparency Receipt is returned to the SE, which is stored in the VW.<a href="#section-6.1-4.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-6.1-4.4">
            <p id="section-6.1-4.4.1">SE Makes a Phone Call:<a href="#section-6.1-4.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-4.4.2.1">
                <p id="section-6.1-4.4.2.1.1">When the SE makes a phone call, the Vesper Wallet builds a Vesper PASSporT by encapsulating the relevant claims (e.g., KYC, TN assignment, and RCD) into a JWT.<a href="#section-6.1-4.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-4.4.2.2">
                <p id="section-6.1-4.4.2.2.1">The Authentication Service (AS) includes the Vesper PASSporT in the SIP header of the call.<a href="#section-6.1-4.4.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-6.1-4.5">
            <p id="section-6.1-4.5.1">Verification Service (VS) Verifies Vesper PASSporT:<a href="#section-6.1-4.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-4.5.2.1">
                <p id="section-6.1-4.5.2.1.1">The VS receives the Vesper PASSporT and verifies the token and included SD-JWTs.<a href="#section-6.1-4.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-4.5.2.2">
                <p id="section-6.1-4.5.2.2.1">Based on the validated claims, the VS makes decisions regarding the call's authenticity and proceeds accordingly.<a href="#section-6.1-4.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
<div class="alignLeft art-text artwork" id="section-6.1-5">
<pre>
+--------------+                    +----------+       +-----------+
|   Subject    |                    | Vetting  |       | Notary    |
|   Entity     |                    |  Claim   |       |  Agent    |
|              |                    |  Agent   |       |           |
+--------------+                    +----------+       +-----------+
      |                                  |                   |
      |&lt;-------- SE creates account -----|                   |
      |                                  |                   |
      |----- Provides KYC values -------&gt;|                   |
      |                                  |                   |
      |&lt;----- KYC Validation complete ---|                   |
      |                                  |- Claim Notary ---&gt;|
      |                                  |&lt;- Notary Receipt -|
      |&lt;-- Receives KYC SD-JWT+Receipt --|                   |
      |                                  |                   |
+--------------+                    +----------+       +-----------+
| Vesper Wallet|                    | Claim    |       | Notary    |
|    (VW)      |                    |  Agents  |       |  Agent    |
+--------------+                    +----------+       +-----------+
      |                                  |                   |
      |-- Requests TN from RTUCA -------&gt;|                   |
      |                                  |                   |
      |&lt;--- Receives TN SD-JWT+Receipt --|                   |
      |                                  |                   |
      |-- Requests RCD Claims ----------&gt;|- Claim Notary ---&gt;|
      |                                  |&lt;- Notary Receipt -|
      |&lt;-- Receives RCD SD-JWT+Receipt --|                   |
      |                                  |                   |
+--------------+                    +----------+
|  Phone Call  |                    | Verifier |
| (Vesper PASS)|                    | Service  |
+--------------+                    +----------+
      |                                  |
      |- Vesper PASSporT in SIP Header -&gt;|
      |                                  |
      |&lt;----------- Verified ------------|
</pre><a href="#section-6.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="notary-agent-flows">
<section id="section-6.2">
        <h3 id="name-notary-agent-flows">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-notary-agent-flows" class="section-name selfRef">Notary Agent Flows</a>
        </h3>
<p id="section-6.2-1">The Notary Agent (NA) is responsible for maintaining the integrity and transparency of Subject Entity (SE) claims through the Claim Graph (CG) and Transparency Log. This section provides an in-depth look at how the NA processes claims, records changes to the Claim Graph, and ensures verifiable, immutable records in the Transparency Log. It also explores how Claim Agents interact with the NA, and how trust is established across the Vesper framework.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div id="claim-graph-1">
<section id="section-6.2.1">
          <h4 id="name-claim-graph-2">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-claim-graph-2" class="section-name selfRef">Claim Graph</a>
          </h4>
<p id="section-6.2.1-1">The CG is a dynamic structure that represents the identity of an SE and tracks all claims related to that identity. Each SE is represented as a node (or IdentityRoot), and additional claims are linked to this root through edges. These claims can represent actions such as KYC validation, telephone number assignments, and rich call data.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">Note: While the Claim Graph is conceptually a graph, its internal representation can be stored simply as, for example, JSON objects in a document database or tables in SQL database for performance optimization.<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="merkle-tree-and-transparency-log">
<section id="section-6.2.2">
          <h4 id="name-merkle-tree-and-transparenc">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-merkle-tree-and-transparenc" class="section-name selfRef">Merkle Tree and Transparency Log</a>
          </h4>
<p id="section-6.2.2-1">The Transparency Log is implemented as a Merkle Tree to provide an immutable and cryptographically secure log of claim changes. Each change to the SE's identity or associated claims results in a new "leaf" being added to the Merkle Tree. This tree structure enables the creation of Notary Receipts, which are verifiable cryptographic proofs that a particular claim was recorded at a specific time.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="vetting-claim-agent-vca-provisions-new-subject-entity">
<section id="section-6.2.3">
          <h4 id="name-vetting-claim-agent-vca-pro">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-vetting-claim-agent-vca-pro" class="section-name selfRef">Vetting Claim Agent (VCA) Provisions New Subject Entity</a>
          </h4>
<p id="section-6.2.3-1">The process begins when the Vetting Claim Agent provisions a new SE. The VCA performs KYC checks on the SE and records the SE's identity in the Claim Graph. The NA creates a new IdentityRoot node for the SE, representing their entity in the system.<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
<p id="section-6.2.3-2">Claim Graph Structure (Entity Creation):<a href="#section-6.2.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3-3">
<pre>
[entity_id]   ---&gt;    {
                        node_type: IdentityRoot,
                        entity_id: 12345,
                        attributes: { ... }
                      }

Transparency Log:
__________________
Tree:        h(d0)
             /
           d0 (Initial creation event)
</pre><a href="#section-6.2.3-3" class="pilcrow">¶</a>
</div>
<p id="section-6.2.3-4">At this point, the SE is issued an SD-JWT containing their KYC claims and a Notary Receipt, which they store in their Vesper Wallet (VW).<a href="#section-6.2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="vetting-claim-agent-adds-kyc-claims">
<section id="section-6.2.4">
          <h4 id="name-vetting-claim-agent-adds-ky">
<a href="#section-6.2.4" class="section-number selfRef">6.2.4. </a><a href="#name-vetting-claim-agent-adds-ky" class="section-name selfRef">Vetting Claim Agent Adds KYC Claims</a>
          </h4>
<p id="section-6.2.4-1">After creating the SE, the VCA adds the KYC claims to the Claim Graph, linking them to the IdentityRoot node. These KYC claims are hashed for privacy.<a href="#section-6.2.4-1" class="pilcrow">¶</a></p>
<p id="section-6.2.4-2">Claim Graph Structure (Adding KYC Claims):<a href="#section-6.2.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.4-3">
<pre>
[entity_id] --- has_kyc ---&gt; [hashed KYC data]

Internal Representation:
{
  node_type: IdentityRoot,
  entity_id: 12345,
  attributes: { ... },
  has_kyc: { hashed_data }
}

Transparency Log:
__________________
Tree:
       h01
      /   \
    h0    h1

Leaves:
   d0    d1 (KYC claims added)
</pre><a href="#section-6.2.4-3" class="pilcrow">¶</a>
</div>
<p id="section-6.2.4-4">The KYC claims are stored in the Transparency Log, and the SE receives an updated KYC SD-JWT with the KYC claims, along with a Notary Receipt that proves the claims have been recorded immutably. This SD-JWT is stored in the Vesper Wallet, and is presented as proof of identity and KYC verification in subsequent interactions with Claim Agents. The x-vesper-kyc header is used to present this SD-JWT to future Claim Agents.<a href="#section-6.2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rtu-claim-agent-adds-telephone-number-tn-assignment">
<section id="section-6.2.5">
          <h4 id="name-rtu-claim-agent-adds-teleph">
<a href="#section-6.2.5" class="section-number selfRef">6.2.5. </a><a href="#name-rtu-claim-agent-adds-teleph" class="section-name selfRef">RTU Claim Agent Adds Telephone Number (TN) Assignment</a>
          </h4>
<p id="section-6.2.5-1">The SE contacts the Right To Use Claim Agent (RTUCA) to request the assignment of one or more telephone numbers (TNs). The RTUCA verifies the SE's identity using the KYC SD-JWT in the x-vesper-kyc header to retrieve the SE's entity_id. After SD-JWT validation, the RTUCA verifies the SE's right to use the telephone number, assigns the telephone number to the SE and updates the Claim Graph.<a href="#section-6.2.5-1" class="pilcrow">¶</a></p>
<p id="section-6.2.5-2">Claim Graph Structure (Adding TN Assignment):<a href="#section-6.2.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.5-3">
<pre>
[TN] &lt;- assigned_tn -- [entity_id] -- has_kyc -&gt; [hashed KYC data]

Internal Representation:
{
  node_type: IdentityRoot,
  entity_id: 12345,
  attributes: { ... },
  has_kyc: { hashed_data },
  assigned_tn: { telephone_number }
}

Transparency Log:
_________________
Tree:
       h02
      /   \
    h01   h2
   /   \
 h0    h1

Leaves:
   d0    d1    d2 (TN assignment added)
</pre><a href="#section-6.2.5-3" class="pilcrow">¶</a>
</div>
<p id="section-6.2.5-4">The TN assignment event is logged in the Transparency Log, and the SE receives an SD-JWT containing the telephone number Right to Use claims and a new Notary Receipt. This SD-JWT is also stored in the SE's Vesper Wallet for future use.<a href="#section-6.2.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="claim-agent-adds-rich-call-data-rcd">
<section id="section-6.2.6">
          <h4 id="name-claim-agent-adds-rich-call-">
<a href="#section-6.2.6" class="section-number selfRef">6.2.6. </a><a href="#name-claim-agent-adds-rich-call-" class="section-name selfRef">Claim Agent Adds Rich Call Data (RCD)</a>
          </h4>
<p id="section-6.2.6-1">Next, the SE contacts the Rich Call Data (RCD) Claim Agent to enrich the SE's telephone call data. The RCD Claim Agent verifies the SE's identity using the KYC SD-JWT and adds the RCD claims to the Claim Graph.<a href="#section-6.2.6-1" class="pilcrow">¶</a></p>
<p id="section-6.2.6-2">Claim Graph Structure (Adding RCD Data):<a href="#section-6.2.6-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.6-3">
<pre>
[TN] &lt;- assigned_tn -- [entity_id] -- has_kyc -&gt; [hashed KYC data]
                            |
                         has_rcd
                            |
                          [RCD]

Internal Representation:
{
  node_type: IdentityRoot,
  entity_id: 12345,
  attributes: { ... },
  has_kyc: { hashed_data },
  assigned_tn: { telephone_number },
  has_rcd: { rich_call_data }
}

Transparency Log:
_________________
Tree:
          hroot
         /    \
      h01     h23
     /   \   /   \
   h0    h1 h2   h3

Leaves:
   d0    d1   d2   d3 (RCD data added)
</pre><a href="#section-6.2.6-3" class="pilcrow">¶</a>
</div>
<p id="section-6.2.6-4">Once again, this event is recorded in the Transparency Log, and the SE receives an updated SD-JWT with the RCD claims and a Notary Receipt. The SE stores this SD-JWT in their Vesper Wallet for future verification.<a href="#section-6.2.6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="using-sd-jwt-for-trust">
<section id="section-6.2.7">
          <h4 id="name-using-sd-jwt-for-trust">
<a href="#section-6.2.7" class="section-number selfRef">6.2.7. </a><a href="#name-using-sd-jwt-for-trust" class="section-name selfRef">Using SD-JWT for Trust</a>
          </h4>
<p id="section-6.2.7-1">Each step in the claim process relies on the SD-JWT issued by the Issuing Agent and passed via the x-vesper-kyc header. Claim Agents can trust the SE based on the following process:<a href="#section-6.2.7-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2.7-2">
<li id="section-6.2.7-2.1">
              <p id="section-6.2.7-2.1.1">The SE presents the KYC SD-JWT and receipt to the Claim Agent in the API request.<a href="#section-6.2.7-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.2.7-2.2">
              <p id="section-6.2.7-2.2.1">The Claim Agent verifies the SD-JWT signature and checks the Transparency Receipt to confirm that the KYC event was logged and notarized by the NA.<a href="#section-6.2.7-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.2.7-2.3">
              <p id="section-6.2.7-2.3.1">Once verified, the Claim Agent can trust the SE's identity and entity_id, allowing further claims (such as TN assignment or RCD claims) to be added securely.<a href="#section-6.2.7-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="notary-agent-api">
<section id="section-6.3">
        <h3 id="name-notary-agent-api">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-notary-agent-api" class="section-name selfRef">Notary Agent API</a>
        </h3>
<p id="section-6.3-1">The Notary Agent (NA) exposes a set of APIs that allow Claim Agents and other authorized participants in the Vesper ecosystem to interact with the Claim Graph (CG) and the Transparency Log. These APIs are designed to provide secure, auditable interactions for creating entities, adding claims, and verifying Notary Receipts. This section outlines the key APIs available for interacting with the NA and provides an overview of their functionality.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<div id="create-subject-entity-se-api">
<section id="section-6.3.1">
          <h4 id="name-create-subject-entity-se-ap">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-create-subject-entity-se-ap" class="section-name selfRef">Create Subject Entity (SE) API</a>
          </h4>
<p id="section-6.3.1-1">This API is used by a Claim Agent, generally always a Vetting Claim Agent (VCA), to provision a new Subject Entity (SE) in the system. The SE is created in the Claim Graph, and a record is added to the Transparency Log.<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
<p id="section-6.3.1-2">Endpoint:
POST /na/entity/create<a href="#section-6.3.1-2" class="pilcrow">¶</a></p>
<p id="section-6.3.1-3">Request:<a href="#section-6.3.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.1-4">
<pre>
{
  "entity_data": {
    "entity_name": "Company A",
    "address": "123 Main St",
    "contact_email": "info@companya.com",
    "contact_phone": "+1234567890"
  },
  "claim_agent": {
    "id": "vca-001",
    "public_key": "public-key-vca-001"
  }
}
</pre><a href="#section-6.3.1-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3.1-5">Response:<a href="#section-6.3.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.1-6">
<pre>
{
  "entity_id": "12345",
  "notary_receipt": "NotaryReceipt1234",
  "sd_jwt": "eyJhbGciOi..."
}
</pre><a href="#section-6.3.1-6" class="pilcrow">¶</a>
</div>
<p id="section-6.3.1-7">entity_data: Information about the SE being created.<br>
claim_agent: The VCA creating the SE, including its ID and public key.<br>
entity_id: The unique identifier assigned to the SE.<br>
notary_receipt: A cryptographic proof that the entity creation was logged in the Transparency Log.<br>
sd_jwt: The SD-JWT containing the KYC claims and the entity_id for the SE.<br><a href="#section-6.3.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="add-kyc-claims-api">
<section id="section-6.3.2">
          <h4 id="name-add-kyc-claims-api">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-add-kyc-claims-api" class="section-name selfRef">Add KYC Claims API</a>
          </h4>
<p id="section-6.3.2-1">Once an SE has been created, the Vetting Claim Agent uses this API to add KYC claims to the Claim Graph. This API also records the event in the Transparency Log and issues a new Notary Receipt.<a href="#section-6.3.2-1" class="pilcrow">¶</a></p>
<p id="section-6.3.2-2">Endpoint:
POST /na/entity/{entity_id}/kyc<a href="#section-6.3.2-2" class="pilcrow">¶</a></p>
<p id="section-6.3.2-3">Request:<a href="#section-6.3.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.2-4">
<pre>
{
  "entity_id": "12345",
  "kyc_data": {
    "full_name": "John Doe",
    "document_id": "ID123456789",
    "issue_date": "2023-01-15"
  },
  "issuing_agent": {
    "id": "vca-001",
    "signature": "signature-of-kyc-data"
  }
}
</pre><a href="#section-6.3.2-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3.2-5">Response:<a href="#section-6.3.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.2-6">
<pre>
{
  "notary_receipt": "NotaryReceipt5678",
  "sd_jwt": "eyJhbGciOi..."
}
</pre><a href="#section-6.3.2-6" class="pilcrow">¶</a>
</div>
<p id="section-6.3.2-7">kyc_data: The KYC claims (hashed for privacy) being added to the SE's Claim Graph.<br>
claim_agent: Information about the VCA making the request, including a signature over the data.<br>
notary_receipt: The Notary Receipt showing that the KYC claims were recorded.<br>
sd_jwt: An SD-JWT containing the KYC claims and the entity_id.<br><a href="#section-6.3.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="add-telephone-number-tn-assignment-api">
<section id="section-6.3.3">
          <h4 id="name-add-telephone-number-tn-ass">
<a href="#section-6.3.3" class="section-number selfRef">6.3.3. </a><a href="#name-add-telephone-number-tn-ass" class="section-name selfRef">Add Telephone Number (TN) Assignment API</a>
          </h4>
<p id="section-6.3.3-1">The Right To Use Claim Agent (RTUCA) uses this API to assign one or more telephone numbers to an SE. The event is logged in the Transparency Log, and an updated SD-JWT is issued to the SE.<a href="#section-6.3.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3.3-2">Endpoint:
POST /na/entity/{entity_id}/tn/assign<a href="#section-6.3.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3.3-3">Request:<a href="#section-6.3.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.3-4">
<pre>
{
  "entity_id": "12345",
  "tn_data": {
    "telephone_numbers": ["+1234567890", "+9876543210"]
  },
  "claim_agent": {
    "id": "rtuca-001",
    "public_key": "public-key-ca-001",
    "signature": "signature-of-tn-data"
  }
}
</pre><a href="#section-6.3.3-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3.3-5">Response:<a href="#section-6.3.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.3-6">
<pre>
{
  "notary_receipt": "NotaryReceipt7890",
  "sd_jwt": "eyJhbGciOi..."
}
</pre><a href="#section-6.3.3-6" class="pilcrow">¶</a>
</div>
<p id="section-6.3.3-7">tn_data: The telephone numbers being assigned to the SE.<br>
claim_agent: Information about the RTUCA making the request.<br>
notary_receipt: Proof that the TN assignment was recorded in the Transparency Log.<br>
sd_jwt: An updated SD-JWT containing the assigned TN claims and the entity_id.<br><a href="#section-6.3.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="add-rich-call-data-rcd-claims-api">
<section id="section-6.3.4">
          <h4 id="name-add-rich-call-data-rcd-clai">
<a href="#section-6.3.4" class="section-number selfRef">6.3.4. </a><a href="#name-add-rich-call-data-rcd-clai" class="section-name selfRef">Add Rich Call Data (RCD) Claims API</a>
          </h4>
<p id="section-6.3.4-1">The Rich Call Data (RCD) Claim Agent uses this API to add RCD claims to the SE's Claim Graph. The RCD data is linked to the SE's telephone numbers, and the event is logged in the Transparency Log.<a href="#section-6.3.4-1" class="pilcrow">¶</a></p>
<p id="section-6.3.4-2">Endpoint:
POST /na/entity/{entity_id}/rcd<a href="#section-6.3.4-2" class="pilcrow">¶</a></p>
<p id="section-6.3.4-3">Request:<a href="#section-6.3.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.4-4">
<pre>
{
  "entity_id": "12345",
  "rcd_data": {
    "call_reason": "Business Inquiry",
    "rcd": {
      "caller_name": "Company A",
      "caller_location": "123 Main St"
    }
  },
  "claim_agent": {
    "id": "rcdca-001",
    "public_key": "public-key-ca-002",
    "signature": "signature-of-rcd-data"
  }
}
</pre><a href="#section-6.3.4-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3.4-5">Response:<a href="#section-6.3.4-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.4-6">
<pre>
{
  "notary_receipt": "NotaryReceipt8901",
  "sd_jwt": "eyJhbGciOi..."
}
</pre><a href="#section-6.3.4-6" class="pilcrow">¶</a>
</div>
<p id="section-6.3.4-7">rcd_data: The RCD claims being added to the SE's identity.<br>
claim_agent: Information about the RCD Claim Agent making the request.<br>
notary_receipt: The updated Notary Receipt showing that the RCD claims were recorded.<br>
sd_jwt: An updated SD-JWT containing the RCD claims and the entity_id.<br><a href="#section-6.3.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify-notary-receipt-api">
<section id="section-6.3.5">
          <h4 id="name-verify-notary-receipt-api">
<a href="#section-6.3.5" class="section-number selfRef">6.3.5. </a><a href="#name-verify-notary-receipt-api" class="section-name selfRef">Verify Notary Receipt API</a>
          </h4>
<p id="section-6.3.5-1">Any verifier can use this API to check the validity of a Notary Receipt. This allows third parties (such as Verification Services) to confirm that a claim was logged in the Transparency Log.<a href="#section-6.3.5-1" class="pilcrow">¶</a></p>
<p id="section-6.3.5-2">Endpoint:
POST /na/verify/receipt<a href="#section-6.3.5-2" class="pilcrow">¶</a></p>
<p id="section-6.3.5-3">Request:<a href="#section-6.3.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.5-4">
<pre>
{
  "receipt": "NotaryReceipt1234"
}
</pre><a href="#section-6.3.5-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3.5-5">Response:<a href="#section-6.3.5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.5-6">
<pre>
{
  "status": "verified",
  "log_entry": {
    "entity_id": "12345",
    "timestamp": "2024-09-09T12:00:00Z",
    "claims": {
      "kyc": "verified",
      "tn": "verified",
      "rcd": "verified"
    }
  }
}
</pre><a href="#section-6.3.5-6" class="pilcrow">¶</a>
</div>
<p id="section-6.3.5-7">receipt: The Notary Receipt being verified.<br>
status: Whether the receipt is valid and recorded in the Transparency Log.<br>
log_entry: Details about the entity_id, timestamp, and verified claims.<br><a href="#section-6.3.5-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="retrieve-entity-history-api">
<section id="section-6.3.6">
          <h4 id="name-retrieve-entity-history-api">
<a href="#section-6.3.6" class="section-number selfRef">6.3.6. </a><a href="#name-retrieve-entity-history-api" class="section-name selfRef">Retrieve Entity History API</a>
          </h4>
<p id="section-6.3.6-1">This API allows authorized participants to retrieve the entire history of an SE from the Transparency Log, including all claims added over time.<a href="#section-6.3.6-1" class="pilcrow">¶</a></p>
<p id="section-6.3.6-2">Endpoint:
GET /na/entity/{entity_id}/history<a href="#section-6.3.6-2" class="pilcrow">¶</a></p>
<p id="section-6.3.6-3">Response:<a href="#section-6.3.6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.6-4">
<pre>
{
  "entity_id": "12345",
  "history": [
    {
      "timestamp": "2024-09-09T12:00:00Z",
      "event": "Entity Created",
      "notary_receipt": "NotaryReceipt1234"
    },
    {
      "timestamp": "2024-09-10T10:00:00Z",
      "event": "KYC Claims Added",
      "notary_receipt": "NotaryReceipt5678"
    },
    {
      "timestamp": "2024-09-11T11:00:00Z",
      "event": "TN Assignment Added",
      "notary_receipt": "NotaryReceipt7890"
    }
  ]
}
</pre><a href="#section-6.3.6-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3.6-5">entity_id: The ID of the SE whose history is being retrieved.<br>
history: A list of all events associated with the SE, including timestamps and Notary Receipts.<br><a href="#section-6.3.6-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="vesper-wallet-flows">
<section id="section-6.4">
        <h3 id="name-vesper-wallet-flows">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-vesper-wallet-flows" class="section-name selfRef">Vesper Wallet Flows</a>
        </h3>
<p id="section-6.4-1">The Vesper Wallet manages claims, cryptographic keys, and the construction of Vesper PASSporTs. It securely stores all claims (in the form of SD-JWTs) along with the corresponding Notary Receipts, which prove that the claims have been notarized by the Notary Agent (NA). Additionally, the Vesper Wallet handles the generation and management of key pairs used for signing PASSporTs and requesting delegate certificates.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<div id="vesper-wallet-key-pair-generation">
<section id="section-6.4.1">
          <h4 id="name-vesper-wallet-key-pair-gene">
<a href="#section-6.4.1" class="section-number selfRef">6.4.1. </a><a href="#name-vesper-wallet-key-pair-gene" class="section-name selfRef">Vesper Wallet Key Pair Generation</a>
          </h4>
<p id="section-6.4.1-1">The Vesper Wallet creates and manages a public/private key pair. This key pair is used for two purposes:<a href="#section-6.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4.1-2.1">
              <p id="section-6.4.1-2.1.1">Requesting Delegate Certificate: The public key is sent to a Certificate Authority (CA) to obtain a Delegate Certificate, which authorizes the SE to use specific telephone numbers (TNs).<a href="#section-6.4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.4.1-2.2">
              <p id="section-6.4.1-2.2.1">Signing Vesper PASSporTs: The private key is used to sign Vesper PASSporTs, which are cryptographically bound to the SE's claims.<a href="#section-6.4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.4.1-3">Key Pair Generation Flow:<a href="#section-6.4.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4.1-4">
<pre>
+-------------------+                 +-----------------+
|  Vesper Wallet    |                 | Certificate     |
|   (VW)            |                 |    Authority    |
+-------------------+                 +-----------------+
      |                                        |
      |&lt;-- Create public/private key pair      |
      |                                        |
      |---&gt; Request Delegate Certificate  ----&gt;|
      |        (Includes public key)           |
      |                                        |
      |&lt;---- Delegate Certificate issued ------|
      |                                        |
</pre><a href="#section-6.4.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="storage-of-sd-jwts-and-notary-receipts">
<section id="section-6.4.2">
          <h4 id="name-storage-of-sd-jwts-and-nota">
<a href="#section-6.4.2" class="section-number selfRef">6.4.2. </a><a href="#name-storage-of-sd-jwts-and-nota" class="section-name selfRef">Storage of SD-JWTs and Notary Receipts</a>
          </h4>
<p id="section-6.4.2-1">The Vesper Wallet stores SD-JWTs for each claim type, along with the corresponding Notary Receipts. These SD-JWTs represent claims such as KYC, telephone number assignment, and rich call data (RCD). The Notary Receipts are proof that each claim has been logged in the Transparency Log by the NA.<a href="#section-6.4.2-1" class="pilcrow">¶</a></p>
<p id="section-6.4.2-2">SD-JWT Storage Structure:<a href="#section-6.4.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4.2-3">
<pre>
+------------------+       +-----------------+
|   Vesper Wallet  |       |  Claims Storage |
+------------------+       +-----------------+
      |                             |
      |--&gt; Stores SD-JWTs ---------&gt;|
      |      + Notary Receipts      |
      |                             |
      +-----------------------------+
</pre><a href="#section-6.4.2-3" class="pilcrow">¶</a>
</div>
<p id="section-6.4.2-4">Each claim stored in the Vesper Wallet contains:<a href="#section-6.4.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4.2-5.1">
              <p id="section-6.4.2-5.1.1">SD-JWT: The selective disclosure JWT containing the claim.<a href="#section-6.4.2-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.4.2-5.2">
              <p id="section-6.4.2-5.2.1">Notary Receipt: Proof from the Transparency Log that the claim was notarized.<a href="#section-6.4.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="building-the-vesper-token">
<section id="section-6.4.3">
          <h4 id="name-building-the-vesper-token">
<a href="#section-6.4.3" class="section-number selfRef">6.4.3. </a><a href="#name-building-the-vesper-token" class="section-name selfRef">Building the Vesper Token</a>
          </h4>
<p id="section-6.4.3-1">When the SE needs to present claims (e.g., during a phone call), the Vesper Wallet constructs a Vesper Token, which serves as a presentation of the claims to the Verification Service (VS). The Vesper Token contains:<a href="#section-6.4.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.4.3-2">
<li id="section-6.4.3-2.1">
              <p id="section-6.4.3-2.1.1">Claim Type: Identifies the type of claim (e.g., KYC, TN, RCD, CC).<a href="#section-6.4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.4.3-2.2">
              <p id="section-6.4.3-2.2.1">SD-JWT: The SD-JWT for the claim, containing selectively disclosable claims.<a href="#section-6.4.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.4.3-2.3">
              <p id="section-6.4.3-2.3.1">Notary Receipt: The Notary Receipt that verifies the claim was recorded in the Transparency Log.<a href="#section-6.4.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-6.4.3-3">Vesper Token Structure:<a href="#section-6.4.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4.3-4">
<pre>
{
  ...
  "claims": [
    {
      "type": "kyc",
      "sd_jwt": "eyJhbGciOi...",
      "receipt": "NotaryReceipt1234"
    },
    {
      "type": "tn",
      "sd_jwt": "eyJhbGci...",
      "receipt": "NotaryReceipt5678"
    },
    {
      "type": "rcd",
      "sd_jwt: "eyJhbGci...",
      "receipt": "NotaryReceipt8901"
    }
  ]
  ...
}
</pre><a href="#section-6.4.3-4" class="pilcrow">¶</a>
</div>
<p id="section-6.4.3-5">The "kyc" and "tn" claim types are mandatory, while the "rcd" and "cc" claim types are optional.<a href="#section-6.4.3-5" class="pilcrow">¶</a></p>
<p id="section-6.4.3-6">Once the Vesper Token is built, it is included in a Vesper PASSporT. The Vesper PASSporT is a specialized form of PASSporT that encapsulates multiple Vesper Tokens and is signed by the SE's private key (the same private key associated with the Delegate Certificate).<a href="#section-6.4.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signing-the-vesper-passport">
<section id="section-6.4.4">
          <h4 id="name-signing-the-vesper-passport">
<a href="#section-6.4.4" class="section-number selfRef">6.4.4. </a><a href="#name-signing-the-vesper-passport" class="section-name selfRef">Signing the Vesper PASSporT</a>
          </h4>
<p id="section-6.4.4-1">The Vesper PASSporT is signed using the SE's private key, which is associated with the Delegate Certificate. This signature binds the claims and their associated receipts to the SE and ensures that the Vesper PASSporT can be trusted by the Verification Service (VS).<a href="#section-6.4.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4.4-2">Signing the Vesper PASSporT:<a href="#section-6.4.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4.4-3">
<pre>
+-------------------+       +----------------------+
|  Vesper Wallet    |       | Delegate Certificate |
+-------------------+       +----------------------+
      |                                |
      |&lt;-- Uses private key to sign  --|
      |   Vesper PASSporT              |
      |                                |
</pre><a href="#section-6.4.4-3" class="pilcrow">¶</a>
</div>
<p id="section-6.4.4-4">The signed Vesper PASSporT is then sent to the Authentication Service (AS), which includes it in the SIP header during a call.<a href="#section-6.4.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="passing-the-vesper-passport-to-the-authentication-service-as">
<section id="section-6.4.5">
          <h4 id="name-passing-the-vesper-passport">
<a href="#section-6.4.5" class="section-number selfRef">6.4.5. </a><a href="#name-passing-the-vesper-passport" class="section-name selfRef">Passing the Vesper PASSporT to the Authentication Service (AS)</a>
          </h4>
<p id="section-6.4.5-1">Once the Vesper PASSporT is signed, it is passed to the Authentication Service (AS). The AS inserts the Vesper PASSporT into the SIP header, which is transmitted as part of the phone call. This allows the Verification Service (VS) to receive the Vesper PASSporT for validation.<a href="#section-6.4.5-1" class="pilcrow">¶</a></p>
<p id="section-6.4.5-2">Sending Vesper PASSporT:<a href="#section-6.4.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4.5-3">
<pre>
+-------------------+       +----------------------+
|  Vesper Wallet    |       | Authentication       |
|   (VW)            |       |     Service (AS)     |
+-------------------+       +----------------------+
      |                                 |
      |-- Pass Vesper PASSporT --------&gt;|
      |      to AS                      |
      |                                 |
</pre><a href="#section-6.4.5-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="verification-of-vesper-passport-by-vs">
<section id="section-6.4.6">
          <h4 id="name-verification-of-vesper-pass">
<a href="#section-6.4.6" class="section-number selfRef">6.4.6. </a><a href="#name-verification-of-vesper-pass" class="section-name selfRef">Verification of Vesper PASSporT by VS</a>
          </h4>
<p id="section-6.4.6-1">When the Verification Service (VS) receives the Vesper PASSporT, it performs several verification steps to ensure the validity of the claims:<a href="#section-6.4.6-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.4.6-2">
<li id="section-6.4.6-2.1">
              <p id="section-6.4.6-2.1.1">Signature Verification: The VS checks the signature on the Vesper PASSporT using the public key from the Delegate Certificate to confirm that the SE legitimately signed the token.<a href="#section-6.4.6-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.4.6-2.2">
              <p id="section-6.4.6-2.2.1">SD-JWT Verification: The VS goes through the SD-JWTs inside the Vesper PASSporT and verifies their individual signatures. Each SD-JWT contains a JWK (JSON Web Key) representing the public key used to sign the claim.<a href="#section-6.4.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-6.4.6-3">JWK Claim Example:<a href="#section-6.4.6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4.6-4">
<pre>
{
  "alg": "RS256",
  "typ": "JWT",
  "jwk": {
    "kty": "RSA",
    "kid": "key-id",
    "n": "...",
    "e": "..."
  }
}
</pre><a href="#section-6.4.6-4" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-6.4.6-5">
<li id="section-6.4.6-5.1">
              <p id="section-6.4.6-5.1.1">Receipt Validation: For each SD-JWT, presence of Notary Receipt should be sufficient to accept the claims.  However, VS may optionally choose to verify the Notary Receipts against the Transparency Log to ensure that the claims were notarized by the NA.  This step would be done out of the call path in different process or service.  If the receipt is not valid, the VS will put the Vesper PASSporT claims on the black list for the future calls.<a href="#section-6.4.6-5.1.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-6.4.6-6">Verification Process:<a href="#section-6.4.6-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4.6-7">
<pre>
+-------------------+        +---------------------+
| Verification      |        |  Transparency Log   |
|  Service (VS)     |        |                     |
+-------------------+        +---------------------+
      |                                 |
      |----&gt; Verifies Vesper PASSporT   |
      |     signature (Delegate Cert)   |
      |                                 |
      |--&gt; Verifies SD-JWTs signatures  |
      |                                 |
      |--- Validates Notary Receipts --&gt;|
      |                                 |
</pre><a href="#section-6.4.6-7" class="pilcrow">¶</a>
</div>
<p id="section-6.4.6-8">Once the Vesper PASSporT and its claims are verified, the VS can make decisions based on the presented claims, such as authenticating the call and allowing it to proceed.<a href="#section-6.4.6-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="the-vesper-passport">
<section id="section-7">
      <h2 id="name-the-vesper-passport">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-the-vesper-passport" class="section-name selfRef">The "vesper" PASSporT</a>
      </h2>
<p id="section-7-1">A Vesper PASSporT introduces a mechanism for the verification of provable claims based on third party validation and vetting of authorized or provable information that the verifier can have greater trust because through the vesper PASSporT and associated claims there is a signed explicit relationship with two important concepts in the vesper framework:<a href="#section-7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.1">
          <p id="section-7-2.1.1">the Claim Agent that is known to be a valid participant in the vesper framework and has a type association with the claims being made<a href="#section-7-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-2.2">
          <p id="section-7-2.2.1">the transparency receipt created by the Notary Agent representing the time and claim assertion event recorded<a href="#section-7-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-3">The Vesper PASSporT is a PASSporT as defined in <span>[<a href="#RFC8225" class="cite xref">RFC8225</a>]</span> which is a JSON Web Token <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> and upon creation should include the standard PASSporT claims including the "orig" and "dest" and "iat" claims required for replay attack protection. It <span class="bcp14">MUST</span> include a PASSporT type, "ppt", with the value of the string "vesper" in the protected header of the PASSporT.
A Vesper PASSporT, as can any PASSporT, can contain any claims that a relying party verification service might understand, but the intention of the Vesper framework is that a Vesper PASSporT contain one or more "vesper" claim objects, defined in the "Vesper Claims" section.<a href="#section-7-3" class="pilcrow">¶</a></p>
<div id="compact-form-and-other-representations-of-vesper-information">
<section id="section-7.1">
        <h3 id="name-compact-form-and-other-repr">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-compact-form-and-other-repr" class="section-name selfRef">Compact Form and Other Representations of Vesper Information</a>
        </h3>
<p id="section-7.1-1">The use of the compact form of PASSporT is not specified for a "vesper" PASSporT primarily because generally or specifically when using the <span>[<a href="#RFC8224" class="cite xref">RFC8224</a>]</span> defined identity header field as the transport of a "vesper" PASSporT there <span class="bcp14">MUST NOT</span> be any corresponding vesper information or claims provided that are unprotected or not signed to validate it's issuer in SIP <span>[<a href="#RFC3261" class="cite xref">RFC3261</a>]</span> or SIP header fields, nor should there be due to the trusted intent of "vesper" claims or "vesper" PASSporTs. "Vesper" claims and PASSporTs are intended to only be used with the identity header field defined in <span>[<a href="#RFC8224" class="cite xref">RFC8224</a>]</span>. Other uses may be considered but <span class="bcp14">MUST</span> consider the use of digital signatures to tie responsible parties and issuers to vesper related information.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="vesper-claims">
<section id="section-8">
      <h2 id="name-vesper-claims">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-vesper-claims" class="section-name selfRef">Vesper Claims</a>
      </h2>
<p id="section-8-1">A Vesper Claim is defined as a JWT claim <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> JSON object with a claim key that is the string "vesper" and with a claim value that is a JSON object containing the following key values:<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">
          <p id="section-8-2.1.1">a "type" key with the claim value as the string that defines the claim agent type defined in the "Claim Agent" section of this document or future claim agent types defined and registered in claim agent IANA registry<a href="#section-8-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.2">
          <p id="section-8-2.2.1">a "claim-token" key with a claim value of the SD-JWT <span>[<a href="#I-D.ietf-oauth-selective-disclosure-jwt" class="cite xref">I-D.ietf-oauth-selective-disclosure-jwt</a>]</span> which represents the actual signed claims from the Claim Agent and defined in the section "Vesper Claim SD-JWT"<a href="#section-8-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.3">
          <p id="section-8-2.3.1">a "receipt" key with the claim value of the Signed Vesper Timestamp the Claim Agent received from the Notary Agent defined in the "Signed Vesper Timestamp" section of the document.<a href="#section-8-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="vesper-claim-sd-jwt-selective-disclosure-json-web-tokens">
<section id="section-8.1">
        <h3 id="name-vesper-claim-sd-jwt-selecti">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-vesper-claim-sd-jwt-selecti" class="section-name selfRef">Vesper Claim SD-JWT (Selective Disclosure JSON Web Tokens)</a>
        </h3>
<p id="section-8.1-1">This section defines the vesper "claims" object "claim-token" key as a SD-JWT, defined in <span>[<a href="#I-D.ietf-oauth-selective-disclosure-jwt" class="cite xref">I-D.ietf-oauth-selective-disclosure-jwt</a>]</span>. The claim and issuance process and disclosure of information closely follows the SD-JWT Issuance and Presentation Flow, Disclosure and Verification, and more generally the three-party model (i.e. Issuer, Holder, Verifier) defined in SD-JWT.  The Issuer in the context of the vesper token is the Claim Agent, the Holder corresponds to the Subject Entity, and the Verifier is the receiver of the Vesper Claim, which in the context of this document would be contained in a Vesper Claim object that is signed inside of a Vesper PASSporT.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sd-jwt-and-disclosures">
<section id="section-8.2">
        <h3 id="name-sd-jwt-and-disclosures">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-sd-jwt-and-disclosures" class="section-name selfRef">SD-JWT and Disclosures</a>
        </h3>
<p id="section-8.2-1">SD-JWT is a digitally signed JSON document containing digests over the selectively disclosable claims with the Disclosures outside the document. Disclosures can be omitted without breaking the signature, and modifying them can be detected. Selectively disclosable claims can be individual object properties (name-value pairs) or array elements. When presenting an SD-JWT to a Verifier, the Holder only includes the Disclosures for the claims that it wants to reveal to that Verifier. An SD-JWT can also contain clear-text claims that are always disclosed to the Verifier.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">To disclose to a Verifier a subset of the SD-JWT claim values, a Holder sends only the Disclosures of those selectively released claims to the Verifier as part of the SD-JWT. The use of Key Binding is an optional feature.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="vesper-claim-sd-jwt-data-formats">
<section id="section-8.3">
        <h3 id="name-vesper-claim-sd-jwt-data-fo">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-vesper-claim-sd-jwt-data-fo" class="section-name selfRef">Vesper Claim SD-JWT Data Formats</a>
        </h3>
<p id="section-8.3-1">An SD-JWT is composed of<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-2.1">
            <p id="section-8.3-2.1.1">an Claim Agent signed JWT, and<a href="#section-8.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-2.2">
            <p id="section-8.3-2.2.1">zero or more Disclosures.<a href="#section-8.3-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.3-3">The serialized format for the SD-JWT is the concatenation of each part delineated with a single tilde ('~') character as follows:<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-4">
<pre>
&lt;Issuer-signed JWT&gt;~&lt;Disclosure 1&gt;~&lt;Disclosure 2&gt;~...~&lt;Disclosure N&gt;~
</pre><a href="#section-8.3-4" class="pilcrow">¶</a>
</div>
<p id="section-8.3-5">The payload of a vesper token as an SD-JWT is a JSON object according to the following rules:<a href="#section-8.3-5" class="pilcrow">¶</a></p>
<p id="section-8.3-6">The payload <span class="bcp14">MAY</span> contain the _sd_alg key described in Section 5.1.1 of <span>[<a href="#I-D.ietf-oauth-selective-disclosure-jwt" class="cite xref">I-D.ietf-oauth-selective-disclosure-jwt</a>]</span>.
The payload <span class="bcp14">MAY</span> contain one or more digests of Disclosures to enable selective disclosure of the respective claims, created and formatted as described in Section 5.2.
The payload <span class="bcp14">MAY</span> contain one or more decoy digests to obscure the actual number of claims in the SD-JWT, created and formatted as described in Section 5.2.5.
The payload <span class="bcp14">MAY</span> contain one or more non-selectively disclosable claims.
The payload <span class="bcp14">MAY</span> contain the Holder's public key(s) or reference(s) thereto, as explained in Section 5.1.2.
The payload <span class="bcp14">MAY</span> contain further claims such as iss, iat, etc. as defined or required by the application using SD-JWTs.<a href="#section-8.3-6" class="pilcrow">¶</a></p>
<p id="section-8.3-7">In order to represent the vetted claim information about a VE. The SD-JWT <span class="bcp14">MUST</span> include the following claims:<a href="#section-8.3-7" class="pilcrow">¶</a></p>
<p id="section-8.3-8">iss: Issuer, the Claim Agent.
sub: Subject, the subject entity represented by a unique entity-id
iat: Issuance timestamp.
exp: Expiry timestamp.
claim-data-hash: Hash of the claim data.
transparency-receipt: Transparency receipt issued by the transparency service.  (SVCT)
(optional) cnf: Public key of the Subject Entity, only if key binding is required, defined in <span>[<a href="#RFC7800" class="cite xref">RFC7800</a>]</span><a href="#section-8.3-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="claim-agents">
<section id="section-9">
      <h2 id="name-claim-agents">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-claim-agents" class="section-name selfRef">Claim Agents</a>
      </h2>
<p id="section-9-1">Claim Agents are entities that act as issuers in the SD-JWT three party trust model, but generally validate information provided by a Subject Entity via either checking an authorized source or via a vetting procedure.  The details of either of these processes are very likely application or jurisdiction specific and should follow an eco-system specific set of policies and therefore are out-of-scope of this document.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">There are different types of claims that can be validated on behalf of a subject entity, but specific to telephone number identities and the entities that are assigned the right to use telephone numbers and more generally the subject and focus of this document there are two required claim types defined in this document and two optional supplemental claim types defined in this document.  It is anticipated that future specifications may define new claim types with additional relevant information that requires trust and validation and therefore an IANA registry for Vesper Claim Agent types is setup to register unique type indicators.<a href="#section-9-2" class="pilcrow">¶</a></p>
<div id="claim-agent-types-and-claim-values">
<section id="section-9.1">
        <h3 id="name-claim-agent-types-and-claim">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-claim-agent-types-and-claim" class="section-name selfRef">Claim Agent Types and Claim Values</a>
        </h3>
<p id="section-9.1-1">Each Claim Agent Type has a corresponding unique string that uniquely identifies a Claim Agent as a particular type and the associated claim object generated by a claim agent to include defined set of claim key values that include both required and optional key values.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<div id="vetting-claim-agent-vca">
<section id="section-9.1.1">
          <h4 id="name-vetting-claim-agent-vca">
<a href="#section-9.1.1" class="section-number selfRef">9.1.1. </a><a href="#name-vetting-claim-agent-vca" class="section-name selfRef">Vetting Claim Agent - "vca"</a>
          </h4>
<p id="section-9.1.1-1">The Vetting Claim Agent is a required claim agent data type and is also the first claim that <span class="bcp14">MUST</span> be established to establish a globally unique entity-id to represent the Subject Entity in the Notary Agent uniquely.<a href="#section-9.1.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1.1-2">The Vetting Claim object is defined to include the following key values in the claim object:<a href="#section-9.1.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.1.1-3">
<pre>
+---------------------+-------------+------------------------------+
| Claim Info Key      | Value Type  | Value Description            |
+---------------------+-------------+------------------------------+
| address             | JSON object |                              |
+---------------------+-------------+------------------------------+
| street_address      | String      |                              |
| locality            | String      |                              |
| region              | String      |                              |
| country             | String      |                              |
| postal_code         | String      |                              |
+---------------------+-------------+------------------------------+
| contact_given_name  | String      |                              |
| contact_family_name | String      |                              |
| contact_email       | String      |                              |
| contact_phone_num   | String      |                              |
+---------------------+-------------+------------------------------+
| business_ids        | JSON Array  |                              |
+---------------------+-------------+------------------------------+
| EIN                 | String      |                              |
+---------------------+-------------+------------------------------+
</pre><a href="#section-9.1.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="right-to-use-claim-agent-rtuca">
<section id="section-9.1.2">
          <h4 id="name-right-to-use-claim-agent-rt">
<a href="#section-9.1.2" class="section-number selfRef">9.1.2. </a><a href="#name-right-to-use-claim-agent-rt" class="section-name selfRef">Right to Use Claim Agent - "rtuca"</a>
          </h4>
<p id="section-9.1.2-1">The Right to Use Claim Agent is a required claim agent data type and is tied to a telephone number service provider or Responsible Organization that is authorized to assign telephone numbers. The Subject Entity has a business relationship with their telephone number provider that also either directly or through a relationship with a Claim Agent can validate the assigned Telephone Number.<a href="#section-9.1.2-1" class="pilcrow">¶</a></p>
<p id="section-9.1.2-2">Note: the telephone number service provider also should provide the mechanism to provide a delegate certificate with the telephone number resource as part of the TNAuthList.<a href="#section-9.1.2-2" class="pilcrow">¶</a></p>
<p id="section-9.1.2-3">The Vetting Claim object is defined to include the following key values in the claim object:<a href="#section-9.1.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.1.2-4">
<pre>
+---------------------+-------------+------------------------------+
| Claim Info Key      | Value Type  | Value Description            |
+---------------------+-------------+------------------------------+
| telephone_num       | Value Array | Array of e.164 Strings       |
+---------------------+-------------+------------------------------+
</pre><a href="#section-9.1.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="rich-call-data-claim-agent-rcdca">
<section id="section-9.1.3">
          <h4 id="name-rich-call-data-claim-agent-">
<a href="#section-9.1.3" class="section-number selfRef">9.1.3. </a><a href="#name-rich-call-data-claim-agent-" class="section-name selfRef">Rich Call Data Claim Agent - "rcdca"</a>
          </h4>
<p id="section-9.1.3-1">The Rich Call Data Claim Agent is an optional claim agent data type and is tied to Rich Call Data as defined in <span>[<a href="#I-D.ietf-stir-passport-rcd" class="cite xref">I-D.ietf-stir-passport-rcd</a>]</span>.<a href="#section-9.1.3-1" class="pilcrow">¶</a></p>
<p id="section-9.1.3-2">The Rich Call Data Claim object is defined to include the following key values in the claim object:<a href="#section-9.1.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.1.3-3">
<pre>
+---------------------+-------------+------------------------------+
| Claim Info Key      | Value Type  | Value Description            |
+---------------------+-------------+------------------------------+
| rcd Array           | JSON Array  | Array of rcd claims objects  |
+---------------------+-------------+------------------------------+
| rcd                 | JSON Object | rcd claim                    |
| rcdi                | JSON Object | rcdi claim                   |
| crn                 | JSON Object | call reason claim            |
+---------------------+-------------+------------------------------+
</pre><a href="#section-9.1.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="consent-claim-agent-cca">
<section id="section-9.1.4">
          <h4 id="name-consent-claim-agent-cca">
<a href="#section-9.1.4" class="section-number selfRef">9.1.4. </a><a href="#name-consent-claim-agent-cca" class="section-name selfRef">Consent Claim Agent - "cca"</a>
          </h4>
<p id="section-9.1.4-1">The Consent Claim Agent is an optional claim agent data type and is tied to a consent assertion associated to a destination telephone number.<a href="#section-9.1.4-1" class="pilcrow">¶</a></p>
<p id="section-9.1.4-2">The Consent Claim object is defined to include the following key values in the claim object:<a href="#section-9.1.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.1.4-3">
<pre>
+---------------------+-------------+------------------------------+
| Claim Info Key      | Value Type  | Value Description            |
+---------------------+-------------+------------------------------+
| consent_assertion   | JSON Array  | Array consent_assertion objs |
+---------------------+-------------+------------------------------+
| consent_type        | String      | consent_type                 |
| destination_tn      | e.164 array | array of destination tns     |
+---------------------+-------------+------------------------------+
</pre><a href="#section-9.1.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="vesper-passport-token-as-a-wrapper-for-multiple-vesper-claims-presentation">
<section id="section-10">
      <h2 id="name-vesper-passport-token-as-a-">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-vesper-passport-token-as-a-" class="section-name selfRef">Vesper PASSporT Token as a wrapper for Multiple Vesper Claims Presentation</a>
      </h2>
<p id="section-10-1">A Subject Entity (SE), acting as the Holder of multiple Vesper claims as SD-JWT + receipts, may need to present a combination of these tokens to satisfy various verification requirements in a single interaction. For instance, in the STIR ecosystem, the SE might first present a vetting Vesper claim to a Telephone Number Service Provider (TNSP) to prove its identity. Once trusted, the TNSP issues a Right To Use (RTU) Vesper claim for a specific Telephone Number (TN) and associated Rich Call Data (RCD). The SE can then present both the vetting and RTU Vesper claims to the AS when signing a call.<a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="structure-of-multiple-vesper-claim-presentation">
<section id="section-10.1">
        <h3 id="name-structure-of-multiple-vespe">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-structure-of-multiple-vespe" class="section-name selfRef">Structure of multiple Vesper Claim Presentation</a>
        </h3>
<p id="section-10.1-1">When creating a multiple Vesper Claim presentation, the SE assembles a package that may contain:<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.1-2">
<li id="section-10.1-2.1">
            <p id="section-10.1-2.1.1">Multiple Base SD-JWTs: The core JWTs from each Vesper token (e.g., KYC/KYB and RTU), representing the vetted claims.<a href="#section-10.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-10.1-2.2">
            <p id="section-10.1-2.2.1">Disclosures: The selectively disclosable claims from each token that are relevant to the verifier.<a href="#section-10.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-10.1-3">The presentation package is composed as follows:<a href="#section-10.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-10.1-4">
<pre>
&lt;SD-JWT-1&gt;~&lt;Disclosure 1-1&gt;~&lt;Disclosure 1-2&gt;~...&lt;SD-JWT-2&gt;~
  &lt;Disclosure 2-1&gt;~&lt;Disclosure 2-2&gt;~
</pre><a href="#section-10.1-4" class="pilcrow">¶</a>
</div>
<p id="section-10.1-5">In this format:<a href="#section-10.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-6.1">
            <p id="section-10.1-6.1.1">&lt;SD-JWT-1&gt; and &lt;SD-JWT-2&gt; represent the KYC/KYB and RTU Vesper tokens, respectively.<a href="#section-10.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-6.2">
            <p id="section-10.1-6.2.1">&lt;Disclosure 1-1&gt;, &lt;Disclosure 1-2&gt;, etc., represent selectively disclosed claims from each token.<a href="#section-10.1-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="preventing-replay-attacks">
<section id="section-11">
      <h2 id="name-preventing-replay-attacks">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-preventing-replay-attacks" class="section-name selfRef">Preventing Replay Attacks</a>
      </h2>
<p id="section-11-1">A replay attack occurs when a malicious actor intercepts a valid token or message and reuses it to gain unauthorized access or perform unauthorized actions. In the context of Vesper tokens, this could involve reusing a token or presentation package to fraudulently sign calls or access services. To address the potential replay attack issue in the Vesper token ecosystem, JWT ID (JTI) claim is used.<a href="#section-11-1" class="pilcrow">¶</a></p>
<div id="mitigation-strategy-jwt-id-jti-claim">
<section id="section-11.1">
        <h3 id="name-mitigation-strategy-jwt-id-">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-mitigation-strategy-jwt-id-" class="section-name selfRef">Mitigation Strategy - JWT ID (JTI) Claim</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-11.1-1.1">
            <p id="section-11.1-1.1.1">Description: The JTI claim is a unique identifier for each JWT. This identifier ensures that each token is distinct, even if it contains the same claims. The JTI can be used by the verifier to track tokens and detect if the same token is being reused maliciously.<a href="#section-11.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.1-1.2">
            <p id="section-11.1-1.2.1">Implementation:<a href="#section-11.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-1.2.2.1">
                <p id="section-11.1-1.2.2.1.1">When a Vesper token (SD-JWT) is issued, the Claim Agent includes a unique jti value in the JWT payload.<a href="#section-11.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-11.1-1.2.2.2">
                <p id="section-11.1-1.2.2.2.1">Verifiers, such as the AS, should store recent JTI values temporarily (e.g., in a cache) to detect if the same token is being presented multiple times within a short period. This prevents replay attacks using old tokens.<a href="#section-11.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-11.1-2">Example:<a href="#section-11.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.1-3">
<pre>
{
  "iss": "https://vetting-claim-agent.example.com",
  "sub": "Business_42",
  "iat": 1683000000,
  "exp": 1883000000,
  "jti": "unique-token-id-12345",
  ...
}
</pre><a href="#section-11.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-issuance">
<section id="section-11.2">
        <h3 id="name-example-issuance">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-example-issuance" class="section-name selfRef">Example Issuance</a>
        </h3>
<p id="section-11.2-1">The Issuer is using the following input claim set:<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2-2">
<pre>
{
  "sub": "Business_42",
  "telephone_number_rtu": [
    +18001231234,
    +18881231234
  ],
  "rcd": [
    {"nam":"Business_42","icn":"https://example.com/logo.png"}
  ]
  "business_ids": [
    {"EIN":"123456789"}
  ]
  "address": {
    "street_address": "123 Main St",
    "locality": "Anytown",
    "region": "Anystate",
    "country": "US"
  },
  "contact_given_name": "John",
  "contact_family_name": "Doe",
  "contact_email": "johndoe@example.com",
  "contact_phone_number": "+12025550101"
}
</pre><a href="#section-11.2-2" class="pilcrow">¶</a>
</div>
<p id="section-11.2-3">The Issuer in this case made the following decisions:<a href="#section-11.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2-4.1">
            <p id="section-11.2-4.1.1">The "telephone_number_rtu" array and contents is always visible.<a href="#section-11.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.2-4.2">
            <p id="section-11.2-4.2.1">The "rcd" array is always visible, but its contents are selectively disclosable.<a href="#section-11.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.2-4.3">
            <p id="section-11.2-4.3.1">The sub element and essential verification data (iss, iat, cnf, etc.) are always visible.<a href="#section-11.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.2-4.4">
            <p id="section-11.2-4.4.1">All other claims are selectively disclosable.<a href="#section-11.2-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.2-4.5">
            <p id="section-11.2-4.5.1">For address, all of the claims can only be selectively disclosed in full.<a href="#section-11.2-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-11.2-5">The following payload is used for the SD-JWT:<a href="#section-11.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2-6">
<pre>
{
  "_sd": [
    "CrQe7S5kqBAHt-nMYXgc6bdt2SH5aTY1sU_M-PgkjPI",
    "JzYjH4svliH0R3PyEMfeZu6Jt69u5qehZo7F7EPYlSE",
    "PorFbpKuVu6xymJagvkFsFXAbRoc2JGlAUA2BA4o7cI",
    "TGf4oLbgwd5JQaHyKVQZU9UdGE0w5rtDsrZzfUaomLo",
    "XQ_3kPKt1XyX7KANkqVR6yZ2Va5NrPIvPYbyMvRKBMM",
    "XzFrzwscM6Gn6CJDc6vVK8BkMnfG8vOSKfpPIZdAfdE",
    "gbOsI4Edq2x2Kw-w5wPEzakob9hV1cRD0ATN3oQL9JM",
    "jsu9yVulwQQlhFlM_3JlzMaSFzglhQG0DpfayQwLUK4"
  ],
  "iss": "https://vetting-claim-agent.example.com",
  "iat": 1683000000,
  "exp": 1883000000,
  "sub": "Business_42",
  "telephone_number_rtu": [
    +18001231234,
    +18881231234
  ],
  "rcd": [
    {
      "...": "pFndjkZ_VCzmyTa6UjlZo3dh-ko8aIKQc9DlGzhaVYo"
    }
  ],
  "business_ids": [
    {
      "...": "7Cf6JkPudry3lcbwHgeZ8khAv1U1OSlerP0VkBJrWZ0"
    }
  ],
  "svt": "8khAv1U1OSlerP0VkBJrWZ07Cf6JkPudry3lcbwHgeZ",
  "vcm": {
      "vcm_version": 1,
      "vetting_agent": {
          "agent_name": "Vetting Authority Inc.",
          "agent_metadata": {}
      },
      "vetted_entity": {
          "entity_id": "VE654321",
          "entity_name": "Business_42"
      },
      "vetting_metadata": []
  },
  "_sd_alg": "sha-256",
  "cnf": {
    "jwk": {
      "kty": "EC",
      "crv": "P-256",
      "x": "TCAER19Zvu3OHF4j4W4vfSVoHIP1ILilDls7vCeGemc",
      "y": "ZxjiWWbZMQGHVWKVQ4hbSIirsVfuecCE6t4jT9F2HZQ"
    }
  }
}
</pre><a href="#section-11.2-6" class="pilcrow">¶</a>
</div>
<p id="section-11.2-7">The following Disclosures are created by the Issuer:<a href="#section-11.2-7" class="pilcrow">¶</a></p>
<p id="section-11.2-8">Claim contact_given_name:<a href="#section-11.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2-9">
<pre>
SHA-256 Hash: jsu9yVulwQQlhFlM_3JlzMaSFzglhQG0DpfayQwLUK4
Disclosure:
WyIyR0xDNDJzS1F2ZUNmR2ZyeU5STjl3IiwgImdpdmVuX25hbWUiLCAiSm9o
biJd
Contents: ["2GLC42sKQveCfGfryNRN9w", "contact_given_name", "John"]
</pre><a href="#section-11.2-9" class="pilcrow">¶</a>
</div>
<p id="section-11.2-10">Claim contact_family_name:<a href="#section-11.2-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2-11">
<pre>
SHA-256 Hash: TGf4oLbgwd5JQaHyKVQZU9UdGE0w5rtDsrZzfUaomLo
Disclosure:
WyJlbHVWNU9nM2dTTklJOEVZbnN4QV9BIiwgImZhbWlseV9uYW1lIiwgIkRv
ZSJd
Contents: ["eluV5Og3gSNII8EYnsxA_A", "contact_family_name", "Doe"]
</pre><a href="#section-11.2-11" class="pilcrow">¶</a>
</div>
<p id="section-11.2-12">Claim contact_email:<a href="#section-11.2-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2-13">
<pre>
SHA-256 Hash: JzYjH4svliH0R3PyEMfeZu6Jt69u5qehZo7F7EPYlSE
Disclosure:
WyI2SWo3dE0tYTVpVlBHYm9TNXRtdlZBIiwgImVtYWlsIiwgImpvaG5kb2VA
ZXhhbXBsZS5jb20iXQ
Contents: ["6Ij7tM-a5iVPGboS5tmvVA", "contact_email",
   "johndoe@example.com"]
</pre><a href="#section-11.2-13" class="pilcrow">¶</a>
</div>
<p id="section-11.2-14">Claim phone_number:<a href="#section-11.2-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2-15">
<pre>
SHA-256 Hash: PorFbpKuVu6xymJagvkFsFXAbRoc2JGlAUA2BA4o7cI
Disclosure:
WyJlSThaV205UW5LUHBOUGVOZW5IZGhRIiwgInBob25lX251bWJlciIsICIr
MS0yMDItNTU1LTAxMDEiXQ
Contents: ["eI8ZWm9QnKPpNPeNenHdhQ", "contact_phone_number",
"+1-202-555-0101"]
</pre><a href="#section-11.2-15" class="pilcrow">¶</a>
</div>
<p id="section-11.2-16">Claim business_ids:<a href="#section-11.2-16" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2-17">
<pre>
SHA-256 Hash: XQ_3kPKt1XyX7KANkqVR6yZ2Va5NrPIvPYbyMvRKBMM
Disclosure:
WyJRZ19PNjR6cUF4ZTQxMmExMDhpcm9BIiwgInBob25lX251bWJlcl92ZXJp
ZmllZCIsIHRydWVd
Contents: ["Qg_O64zqAxe412a108iroA", "business_ids", true]
</pre><a href="#section-11.2-17" class="pilcrow">¶</a>
</div>
<p id="section-11.2-18">Claim address:<a href="#section-11.2-18" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2-19">
<pre>
SHA-256 Hash: XzFrzwscM6Gn6CJDc6vVK8BkMnfG8vOSKfpPIZdAfdE
Disclosure:
WyJBSngtMDk1VlBycFR0TjRRTU9xUk9BIiwgImFkZHJlc3MiLCB7InN0cmVl
dF9hZGRyZXNzIjogIjEyMyBNYWluIFN0IiwgImxvY2FsaXR5IjogIkFueXRv
d24iLCAicmVnaW9uIjogIkFueXN0YXRlIiwgImNvdW50cnkiOiAiVVMifV0
Contents: ["AJx-095VPrpTtN4QMOqROA", "address", {"street_address":
"123 Main St", "locality": "Anytown", "region": "Anystate",
"country": "US"}]
</pre><a href="#section-11.2-19" class="pilcrow">¶</a>
</div>
<p id="section-11.2-20">Array Entry:<a href="#section-11.2-20" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2-21">
<pre>
SHA-256 Hash: pFndjkZ_VCzmyTa6UjlZo3dh-ko8aIKQc9DlGzhaVYo
Disclosure: WyJsa2x4RjVqTVlsR1RQVW92TU5JdkNBIiwgIlVTIl0
Contents: ["lklxF5jMYlGTPUovMNIvCA", "{"nam":"Business_42",
  "icn":"https://example.com/logo.png"}"]
</pre><a href="#section-11.2-21" class="pilcrow">¶</a>
</div>
<p id="section-11.2-22">Array Entry:<a href="#section-11.2-22" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2-23">
<pre>
SHA-256 Hash: 7Cf6JkPudry3lcbwHgeZ8khAv1U1OSlerP0VkBJrWZ0
Disclosure: WyJuUHVvUW5rUkZxM0JJZUFtN0FuWEZBIiwgIkRFIl0
Contents: ["nPuoQnkRFq3BIeAm7AnXFA", "123456789"]
</pre><a href="#section-11.2-23" class="pilcrow">¶</a>
</div>
<p id="section-11.2-24">The payload is then signed by the Issuer to create a JWT like the following:<a href="#section-11.2-24" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2-25">
<pre>
eyJhbGciOiAiRVMyNTYiLCAidHlwIjogImV4YW1wbGUrc2Qtand0In0.eyJfc2QiOiBb
IkNyUWU3UzVrcUJBSHQtbk1ZWGdjNmJkdDJTSDVhVFkxc1VfTS1QZ2tqUEkiLCAiSnpZ
akg0c3ZsaUgwUjNQeUVNZmVadTZKdDY5dTVxZWhabzdGN0VQWWxTRSIsICJQb3JGYnBL
dVZ1Nnh5bUphZ3ZrRnNGWEFiUm9jMkpHbEFVQTJCQTRvN2NJIiwgIlRHZjRvTGJnd2Q1
SlFhSHlLVlFaVTlVZEdFMHc1cnREc3JaemZVYW9tTG8iLCAiWFFfM2tQS3QxWHlYN0tB
TmtxVlI2eVoyVmE1TnJQSXZQWWJ5TXZSS0JNTSIsICJYekZyendzY002R242Q0pEYzZ2
Vks4QmtNbmZHOHZPU0tmcFBJWmRBZmRFIiwgImdiT3NJNEVkcTJ4Mkt3LXc1d1BFemFr
b2I5aFYxY1JEMEFUTjNvUUw5Sk0iLCAianN1OXlWdWx3UVFsaEZsTV8zSmx6TWFTRnpn
bGhRRzBEcGZheVF3TFVLNCJdLCAiaXNzIjogImh0dHBzOi8vaXNzdWVyLmV4YW1wbGUu
Y29tIiwgImlhdCI6IDE2ODMwMDAwMDAsICJleHAiOiAxODgzMDAwMDAwLCAic3ViIjog
InVzZXJfNDIiLCAibmF0aW9uYWxpdGllcyI6IFt7Ii4uLiI6ICJwRm5kamtaX1ZDem15
VGE2VWpsWm8zZGgta284YUlLUWM5RGxHemhhVllvIn0sIHsiLi4uIjogIjdDZjZKa1B1
ZHJ5M2xjYndIZ2VaOGtoQXYxVTFPU2xlclAwVmtCSnJXWjAifV0sICJfc2RfYWxnIjog
InNoYS0yNTYiLCAiY25mIjogeyJqd2siOiB7Imt0eSI6ICJFQyIsICJjcnYiOiAiUC0y
NTYiLCAieCI6ICJUQ0FFUjE5WnZ1M09IRjRqNFc0dmZTVm9ISVAxSUxpbERsczd2Q2VH
ZW1jIiwgInkiOiAiWnhqaVdXYlpNUUdIVldLVlE0aGJTSWlyc1ZmdWVjQ0U2dDRqVDlG
MkhaUSJ9fX0.XaB1KmNGBE-uKjT8M3VSu65QVWdNMjuhJI1sIEM4TIEs6Ae2f0DfWP80
TAg79QIhbz04IIrrXyrEbzkeZLoVHQ

The issued SD-JWT might look as follows:

eyJhbGciOiAiRVMyNTYiLCAidHlwIjogImV4YW1wbGUrc2Qtand0In0.eyJfc2QiOiBb
IkNyUWU3UzVrcUJBSHQtbk1ZWGdjNmJkdDJTSDVhVFkxc1VfTS1QZ2tqUEkiLCAiSnpZ
akg0c3ZsaUgwUjNQeUVNZmVadTZKdDY5dTVxZWhabzdGN0VQWWxTRSIsICJQb3JGYnBL
dVZ1Nnh5bUphZ3ZrRnNGWEFiUm9jMkpHbEFVQTJCQTRvN2NJIiwgIlRHZjRvTGJnd2Q1
SlFhSHlLVlFaVTlVZEdFMHc1cnREc3JaemZVYW9tTG8iLCAiWFFfM2tQS3QxWHlYN0tB
TmtxVlI2eVoyVmE1TnJQSXZQWWJ5TXZSS0JNTSIsICJYekZyendzY002R242Q0pEYzZ2
Vks4QmtNbmZHOHZPU0tmcFBJWmRBZmRFIiwgImdiT3NJNEVkcTJ4Mkt3LXc1d1BFemFr
b2I5aFYxY1JEMEFUTjNvUUw5Sk0iLCAianN1OXlWdWx3UVFsaEZsTV8zSmx6TWFTRnpn
bGhRRzBEcGZheVF3TFVLNCJdLCAiaXNzIjogImh0dHBzOi8vaXNzdWVyLmV4YW1wbGUu
Y29tIiwgImlhdCI6IDE2ODMwMDAwMDAsICJleHAiOiAxODgzMDAwMDAwLCAic3ViIjog
InVzZXJfNDIiLCAibmF0aW9uYWxpdGllcyI6IFt7Ii4uLiI6ICJwRm5kamtaX1ZDem15
VGE2VWpsWm8zZGgta284YUlLUWM5RGxHemhhVllvIn0sIHsiLi4uIjogIjdDZjZKa1B1
ZHJ5M2xjYndIZ2VaOGtoQXYxVTFPU2xlclAwVmtCSnJXWjAifV0sICJfc2RfYWxnIjog
InNoYS0yNTYiLCAiY25mIjogeyJqd2siOiB7Imt0eSI6ICJFQyIsICJjcnYiOiAiUC0y
NTYiLCAieCI6ICJUQ0FFUjE5WnZ1M09IRjRqNFc0dmZTVm9ISVAxSUxpbERsczd2Q2VH
ZW1jIiwgInkiOiAiWnhqaVdXYlpNUUdIVldLVlE0aGJTSWlyc1ZmdWVjQ0U2dDRqVDlG
MkhaUSJ9fX0.XaB1KmNGBE-uKjT8M3VSu65QVWdNMjuhJI1sIEM4TIEs6Ae2f0DfWP80
TAg79QIhbz04IIrrXyrEbzkeZLoVHQ~WyIyR0xDNDJzS1F2ZUNmR2ZyeU5STjl3IiwgI
mdpdmVuX25hbWUiLCAiSm9obiJd~WyJlbHVWNU9nM2dTTklJOEVZbnN4QV9BIiwgImZh
bWlseV9uYW1lIiwgIkRvZSJd~WyI2SWo3dE0tYTVpVlBHYm9TNXRtdlZBIiwgImVtYWl
sIiwgImpvaG5kb2VAZXhhbXBsZS5jb20iXQ~WyJlSThaV205UW5LUHBOUGVOZW5IZGhR
IiwgInBob25lX251bWJlciIsICIrMS0yMDItNTU1LTAxMDEiXQ~WyJRZ19PNjR6cUF4Z
TQxMmExMDhpcm9BIiwgInBob25lX251bWJlcl92ZXJpZmllZCIsIHRydWVd~WyJBSngt
MDk1VlBycFR0TjRRTU9xUk9BIiwgImFkZHJlc3MiLCB7InN0cmVldF9hZGRyZXNzIjog
IjEyMyBNYWluIFN0IiwgImxvY2FsaXR5IjogIkFueXRvd24iLCAicmVnaW9uIjogIkFu
eXN0YXRlIiwgImNvdW50cnkiOiAiVVMifV0~WyJQYzMzSk0yTGNoY1VfbEhnZ3ZfdWZR
IiwgImJpcnRoZGF0ZSIsICIxOTQwLTAxLTAxIl0~WyJHMDJOU3JRZmpGWFE3SW8wOXN5
YWpBIiwgInVwZGF0ZWRfYXQiLCAxNTcwMDAwMDAwXQ~WyJsa2x4RjVqTVlsR1RQVW92T
U5JdkNBIiwgIlVTIl0~WyJuUHVvUW5rUkZxM0JJZUFtN0FuWEZBIiwgIkRFIl0~
</pre><a href="#section-11.2-25" class="pilcrow">¶</a>
</div>
<p id="section-11.2-26">Presentation<a href="#section-11.2-26" class="pilcrow">¶</a></p>
<p id="section-11.2-27">The following non-normative example shows a Vesper PASSporT as it would be sent from the Holder (SE) to the Verifier.<a href="#section-11.2-27" class="pilcrow">¶</a></p>
<p id="section-11.2-28">Add Example<a href="#section-11.2-28" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-12">
      <h2 id="name-security-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-12-1">TODO Security<a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-13">
      <h2 id="name-iana-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="json-web-token-claims">
<section id="section-13.1">
        <h3 id="name-json-web-token-claims">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-json-web-token-claims" class="section-name selfRef">JSON Web Token claims</a>
        </h3>
<p id="section-13.1-1">This specification requests that the IANA add two new claims to the JSON Web Token Claims registry as defined in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<p id="section-13.1-2">Claim Name: "vesper"<a href="#section-13.1-2" class="pilcrow">¶</a></p>
<p id="section-13.1-3">Claim Description: A JSON object that includes both an SD-JWT object containing Vesper Claims from a Vesper Claim Agent and a Notary Agent transparency receipt object as required by the STIR Vesper framework<a href="#section-13.1-3" class="pilcrow">¶</a></p>
<p id="section-13.1-4">Change Controller: IESG<a href="#section-13.1-4" class="pilcrow">¶</a></p>
<p id="section-13.1-5">Specification Document(s): [RFCThis]<a href="#section-13.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="passport-types">
<section id="section-13.2">
        <h3 id="name-passport-types">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-passport-types" class="section-name selfRef">PASSporT Types</a>
        </h3>
<p id="section-13.2-1">This specification requests that the IANA add a new entry to the Personal Assertion Token (PASSporT) Extensions registry for the type "vesper" which is specified in [RFCThis].<a href="#section-13.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-normative-references">
<section id="section-14">
      <h2 id="name-normative-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="I-D.ietf-oauth-selective-disclosure-jwt">[I-D.ietf-oauth-selective-disclosure-jwt]</dt>
      <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Yasuda, K.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"Selective Disclosure for JWTs (SD-JWT)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-selective-disclosure-jwt-13</span>, <time datetime="2024-10-18" class="refDate">18 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt-13">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-sipcore-callinfo-spam">[I-D.ietf-sipcore-callinfo-spam]</dt>
      <dd>
<span class="refAuthor">Schulzrinne, H.</span>, <span class="refTitle">"SIP Call-Info Parameters for Labeling Calls"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-sipcore-callinfo-spam-04</span>, <time datetime="2019-08-30" class="refDate">30 August 2019</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-sipcore-callinfo-spam-04">https://datatracker.ietf.org/doc/html/draft-ietf-sipcore-callinfo-spam-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-stir-passport-rcd">[I-D.ietf-stir-passport-rcd]</dt>
      <dd>
<span class="refAuthor">Wendt, C.</span> and <span class="refAuthor">J. Peterson</span>, <span class="refTitle">"PASSporT Extension for Rich Call Data"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-stir-passport-rcd-26</span>, <time datetime="2023-06-05" class="refDate">5 June 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-stir-passport-rcd-26">https://datatracker.ietf.org/doc/html/draft-ietf-stir-passport-rcd-26</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3261">[RFC3261]</dt>
      <dd>
<span class="refAuthor">Rosenberg, J.</span>, <span class="refAuthor">Schulzrinne, H.</span>, <span class="refAuthor">Camarillo, G.</span>, <span class="refAuthor">Johnston, A.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Sparks, R.</span>, <span class="refAuthor">Handley, M.</span>, and <span class="refAuthor">E. Schooler</span>, <span class="refTitle">"SIP: Session Initiation Protocol"</span>, <span class="seriesInfo">RFC 3261</span>, <span class="seriesInfo">DOI 10.17487/RFC3261</span>, <time datetime="2002-06" class="refDate">June 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3261">https://www.rfc-editor.org/rfc/rfc3261</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7800">[RFC7800]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for JSON Web Tokens (JWTs)"</span>, <span class="seriesInfo">RFC 7800</span>, <span class="seriesInfo">DOI 10.17487/RFC7800</span>, <time datetime="2016-04" class="refDate">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7800">https://www.rfc-editor.org/rfc/rfc7800</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8224">[RFC8224]</dt>
      <dd>
<span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Jennings, C.</span>, <span class="refAuthor">Rescorla, E.</span>, and <span class="refAuthor">C. Wendt</span>, <span class="refTitle">"Authenticated Identity Management in the Session Initiation Protocol (SIP)"</span>, <span class="seriesInfo">RFC 8224</span>, <span class="seriesInfo">DOI 10.17487/RFC8224</span>, <time datetime="2018-02" class="refDate">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8224">https://www.rfc-editor.org/rfc/rfc8224</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8225">[RFC8225]</dt>
      <dd>
<span class="refAuthor">Wendt, C.</span> and <span class="refAuthor">J. Peterson</span>, <span class="refTitle">"PASSporT: Personal Assertion Token"</span>, <span class="seriesInfo">RFC 8225</span>, <span class="seriesInfo">DOI 10.17487/RFC8225</span>, <time datetime="2018-02" class="refDate">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8225">https://www.rfc-editor.org/rfc/rfc8225</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8226">[RFC8226]</dt>
    <dd>
<span class="refAuthor">Peterson, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Secure Telephone Identity Credentials: Certificates"</span>, <span class="seriesInfo">RFC 8226</span>, <span class="seriesInfo">DOI 10.17487/RFC8226</span>, <time datetime="2018-02" class="refDate">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8226">https://www.rfc-editor.org/rfc/rfc8226</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Chris Wendt</span></div>
<div dir="auto" class="left"><span class="org">Somos, Inc.</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:chris@appliedbits.com" class="email">chris@appliedbits.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rob Sliwa</span></div>
<div dir="auto" class="left"><span class="org">Somos, Inc.</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:robjsliwa@gmail.com" class="email">robjsliwa@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
